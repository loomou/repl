var mr=Object.defineProperty;var yr=(r,e,t)=>e in r?mr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var g=(r,e,t)=>yr(r,typeof e!="symbol"?e+"":e,t);const br="modulepreload",_r=function(r,e){return new URL(r,e).href},Xt={},wr=function(r,e,t){let n=Promise.resolve();if(e&&e.length>0){const s=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.all(e.map(f=>{if(f=_r(f,t),f in Xt)return;Xt[f]=!0;const u=f.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(t)for(let y=s.length-1;y>=0;y--){const b=s[y];if(b.href===f&&(!u||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${p}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":br,u||(h.as="script",h.crossOrigin=""),h.href=f,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((y,b)=>{h.addEventListener("load",y),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}return n.then(()=>r()).catch(s=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s})};function Sr(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Jt={exports:{}},U=Jt.exports={},re,oe;function gt(){throw new Error("setTimeout has not been defined")}function mt(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?re=setTimeout:re=gt}catch{re=gt}try{typeof clearTimeout=="function"?oe=clearTimeout:oe=mt}catch{oe=mt}})();function Qt(r){if(re===setTimeout)return setTimeout(r,0);if((re===gt||!re)&&setTimeout)return re=setTimeout,setTimeout(r,0);try{return re(r,0)}catch{try{return re.call(null,r,0)}catch{return re.call(this,r,0)}}}function kr(r){if(oe===clearTimeout)return clearTimeout(r);if((oe===mt||!oe)&&clearTimeout)return oe=clearTimeout,clearTimeout(r);try{return oe(r)}catch{try{return oe.call(null,r)}catch{return oe.call(this,r)}}}var ae=[],_e=!1,he,qe=-1;function vr(){!_e||!he||(_e=!1,he.length?ae=he.concat(ae):qe=-1,ae.length&&Zt())}function Zt(){if(!_e){var r=Qt(vr);_e=!0;for(var e=ae.length;e;){for(he=ae,ae=[];++qe<e;)he&&he[qe].run();qe=-1,e=ae.length}he=null,_e=!1,kr(r)}}U.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];ae.push(new en(r,e)),ae.length===1&&!_e&&Qt(Zt)};function en(r,e){this.fun=r,this.array=e}en.prototype.run=function(){this.fun.apply(null,this.array)},U.title="browser",U.browser=!0,U.env={},U.argv=[],U.version="",U.versions={};function le(){}U.on=le,U.addListener=le,U.once=le,U.off=le,U.removeListener=le,U.removeAllListeners=le,U.emit=le,U.prependListener=le,U.prependOnceListener=le,U.listeners=function(r){return[]},U.binding=function(r){throw new Error("process.binding is not supported")},U.cwd=function(){return"/"},U.chdir=function(r){throw new Error("process.chdir is not supported")},U.umask=function(){return 0};var Cr=Jt.exports;const Ar=Sr(Cr);var tn={},We={};We.byteLength=Nr,We.toByteArray=Pr,We.fromByteArray=Or;for(var se=[],Z=[],Er=typeof Uint8Array<"u"?Uint8Array:Array,yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",we=0,Tr=yt.length;we<Tr;++we)se[we]=yt[we],Z[yt.charCodeAt(we)]=we;Z[45]=62,Z[95]=63;function nn(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function Nr(r){var e=nn(r),t=e[0],n=e[1];return(t+n)*3/4-n}function Lr(r,e,t){return(e+t)*3/4-t}function Pr(r){var e,t=nn(r),n=t[0],s=t[1],i=new Er(Lr(r,n,s)),l=0,f=s>0?n-4:n,u;for(u=0;u<f;u+=4)e=Z[r.charCodeAt(u)]<<18|Z[r.charCodeAt(u+1)]<<12|Z[r.charCodeAt(u+2)]<<6|Z[r.charCodeAt(u+3)],i[l++]=e>>16&255,i[l++]=e>>8&255,i[l++]=e&255;return s===2&&(e=Z[r.charCodeAt(u)]<<2|Z[r.charCodeAt(u+1)]>>4,i[l++]=e&255),s===1&&(e=Z[r.charCodeAt(u)]<<10|Z[r.charCodeAt(u+1)]<<4|Z[r.charCodeAt(u+2)]>>2,i[l++]=e>>8&255,i[l++]=e&255),i}function Rr(r){return se[r>>18&63]+se[r>>12&63]+se[r>>6&63]+se[r&63]}function Ir(r,e,t){for(var n,s=[],i=e;i<t;i+=3)n=(r[i]<<16&16711680)+(r[i+1]<<8&65280)+(r[i+2]&255),s.push(Rr(n));return s.join("")}function Or(r){for(var e,t=r.length,n=t%3,s=[],i=16383,l=0,f=t-n;l<f;l+=i)s.push(Ir(r,l,l+i>f?f:l+i));return n===1?(e=r[t-1],s.push(se[e>>2]+se[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],s.push(se[e>>10]+se[e>>4&63]+se[e<<2&63]+"=")),s.join("")}var bt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */bt.read=function(r,e,t,n,s){var i,l,f=s*8-n-1,u=(1<<f)-1,p=u>>1,h=-7,y=t?s-1:0,b=t?-1:1,w=r[e+y];for(y+=b,i=w&(1<<-h)-1,w>>=-h,h+=f;h>0;i=i*256+r[e+y],y+=b,h-=8);for(l=i&(1<<-h)-1,i>>=-h,h+=n;h>0;l=l*256+r[e+y],y+=b,h-=8);if(i===0)i=1-p;else{if(i===u)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,n),i=i-p}return(w?-1:1)*l*Math.pow(2,i-n)},bt.write=function(r,e,t,n,s,i){var l,f,u,p=i*8-s-1,h=(1<<p)-1,y=h>>1,b=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:i-1,k=n?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,l=h):(l=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-l))<1&&(l--,u*=2),l+y>=1?e+=b/u:e+=b*Math.pow(2,1-y),e*u>=2&&(l++,u/=2),l+y>=h?(f=0,l=h):l+y>=1?(f=(e*u-1)*Math.pow(2,s),l=l+y):(f=e*Math.pow(2,y-1)*Math.pow(2,s),l=0));s>=8;r[t+w]=f&255,w+=k,f/=256,s-=8);for(l=l<<s|f,p+=s;p>0;r[t+w]=l&255,w+=k,l/=256,p-=8);r[t+w-k]|=_*128};/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/(function(r){const e=We,t=bt,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=h,r.SlowBuffer=L,r.INSPECT_MAX_BYTES=50;const s=2147483647;r.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:l,SharedArrayBuffer:f}=globalThis;h.TYPED_ARRAY_SUPPORT=u(),!h.TYPED_ARRAY_SUPPORT&&typeof console<"u";function u(){try{const o=new i(1),a={foo:function(){return 42}};return Object.setPrototypeOf(a,i.prototype),Object.setPrototypeOf(o,a),o.foo()===42}catch{return!1}}Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}});function p(o){if(o>s)throw new RangeError('The value "'+o+'" is invalid for option "size"');const a=new i(o);return Object.setPrototypeOf(a,h.prototype),a}function h(o,a,c){if(typeof o=="number"){if(typeof a=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return k(o)}return y(o,a,c)}h.poolSize=8192;function y(o,a,c){if(typeof o=="string")return _(o,a);if(l.isView(o))return N(o);if(o==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(ne(o,l)||o&&ne(o.buffer,l)||typeof f<"u"&&(ne(o,f)||o&&ne(o.buffer,f)))return P(o,a,c);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const d=o.valueOf&&o.valueOf();if(d!=null&&d!==o)return h.from(d,a,c);const m=E(o);if(m)return m;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return h.from(o[Symbol.toPrimitive]("string"),a,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}h.from=function(o,a,c){return y(o,a,c)},Object.setPrototypeOf(h.prototype,i.prototype),Object.setPrototypeOf(h,i);function b(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function w(o,a,c){return b(o),o<=0?p(o):a!==void 0?typeof c=="string"?p(o).fill(a,c):p(o).fill(a):p(o)}h.alloc=function(o,a,c){return w(o,a,c)};function k(o){return b(o),p(o<0?0:T(o)|0)}h.allocUnsafe=function(o){return k(o)},h.allocUnsafeSlow=function(o){return k(o)};function _(o,a){if((typeof a!="string"||a==="")&&(a="utf8"),!h.isEncoding(a))throw new TypeError("Unknown encoding: "+a);const c=R(o,a)|0;let d=p(c);const m=d.write(o,a);return m!==c&&(d=d.slice(0,m)),d}function A(o){const a=o.length<0?0:T(o.length)|0,c=p(a);for(let d=0;d<a;d+=1)c[d]=o[d]&255;return c}function N(o){if(ne(o,i)){const a=new i(o);return P(a.buffer,a.byteOffset,a.byteLength)}return A(o)}function P(o,a,c){if(a<0||o.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<a+(c||0))throw new RangeError('"length" is outside of buffer bounds');let d;return a===void 0&&c===void 0?d=new i(o):c===void 0?d=new i(o,a):d=new i(o,a,c),Object.setPrototypeOf(d,h.prototype),d}function E(o){if(h.isBuffer(o)){const a=T(o.length)|0,c=p(a);return c.length===0||o.copy(c,0,0,a),c}if(o.length!==void 0)return typeof o.length!="number"||dt(o.length)?p(0):A(o);if(o.type==="Buffer"&&Array.isArray(o.data))return A(o.data)}function T(o){if(o>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return o|0}function L(o){return+o!=o&&(o=0),h.alloc(+o)}h.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==h.prototype},h.compare=function(o,a){if(ne(o,i)&&(o=h.from(o,o.offset,o.byteLength)),ne(a,i)&&(a=h.from(a,a.offset,a.byteLength)),!h.isBuffer(o)||!h.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===a)return 0;let c=o.length,d=a.length;for(let m=0,S=Math.min(c,d);m<S;++m)if(o[m]!==a[m]){c=o[m],d=a[m];break}return c<d?-1:d<c?1:0},h.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(o,a){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return h.alloc(0);let c;if(a===void 0)for(a=0,c=0;c<o.length;++c)a+=o[c].length;const d=h.allocUnsafe(a);let m=0;for(c=0;c<o.length;++c){let S=o[c];if(ne(S,i))m+S.length>d.length?(h.isBuffer(S)||(S=h.from(S)),S.copy(d,m)):i.prototype.set.call(d,S,m);else if(h.isBuffer(S))S.copy(d,m);else throw new TypeError('"list" argument must be an Array of Buffers');m+=S.length}return d};function R(o,a){if(h.isBuffer(o))return o.length;if(l.isView(o)||ne(o,l))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);const c=o.length,d=arguments.length>2&&arguments[2]===!0;if(!d&&c===0)return 0;let m=!1;for(;;)switch(a){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return pt(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return Vt(o).length;default:if(m)return d?-1:pt(o).length;a=(""+a).toLowerCase(),m=!0}}h.byteLength=R;function Y(o,a,c){let d=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,a>>>=0,c<=a))return"";for(o||(o="utf8");;)switch(o){case"hex":return ar(this,a,c);case"utf8":case"utf-8":return Dt(this,a,c);case"ascii":return sr(this,a,c);case"latin1":case"binary":return ir(this,a,c);case"base64":return rr(this,a,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lr(this,a,c);default:if(d)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),d=!0}}h.prototype._isBuffer=!0;function j(o,a,c){const d=o[a];o[a]=o[c],o[c]=d}h.prototype.swap16=function(){const o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let a=0;a<o;a+=2)j(this,a,a+1);return this},h.prototype.swap32=function(){const o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let a=0;a<o;a+=4)j(this,a,a+3),j(this,a+1,a+2);return this},h.prototype.swap64=function(){const o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let a=0;a<o;a+=8)j(this,a,a+7),j(this,a+1,a+6),j(this,a+2,a+5),j(this,a+3,a+4);return this},h.prototype.toString=function(){const o=this.length;return o===0?"":arguments.length===0?Dt(this,0,o):Y.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(o){if(!h.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:h.compare(this,o)===0},h.prototype.inspect=function(){let o="";const a=r.INSPECT_MAX_BYTES;return o=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(o+=" ... "),"<Buffer "+o+">"},n&&(h.prototype[n]=h.prototype.inspect),h.prototype.compare=function(o,a,c,d,m){if(ne(o,i)&&(o=h.from(o,o.offset,o.byteLength)),!h.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(a===void 0&&(a=0),c===void 0&&(c=o?o.length:0),d===void 0&&(d=0),m===void 0&&(m=this.length),a<0||c>o.length||d<0||m>this.length)throw new RangeError("out of range index");if(d>=m&&a>=c)return 0;if(d>=m)return-1;if(a>=c)return 1;if(a>>>=0,c>>>=0,d>>>=0,m>>>=0,this===o)return 0;let S=m-d,C=c-a;const x=Math.min(S,C),H=this.slice(d,m),M=o.slice(a,c);for(let O=0;O<x;++O)if(H[O]!==M[O]){S=H[O],C=M[O];break}return S<C?-1:C<S?1:0};function Ee(o,a,c,d,m){if(o.length===0)return-1;if(typeof c=="string"?(d=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,dt(c)&&(c=m?0:o.length-1),c<0&&(c=o.length+c),c>=o.length){if(m)return-1;c=o.length-1}else if(c<0)if(m)c=0;else return-1;if(typeof a=="string"&&(a=h.from(a,d)),h.isBuffer(a))return a.length===0?-1:De(o,a,c,d,m);if(typeof a=="number")return a=a&255,typeof i.prototype.indexOf=="function"?m?i.prototype.indexOf.call(o,a,c):i.prototype.lastIndexOf.call(o,a,c):De(o,[a],c,d,m);throw new TypeError("val must be string, number or Buffer")}function De(o,a,c,d,m){let S=1,C=o.length,x=a.length;if(d!==void 0&&(d=String(d).toLowerCase(),d==="ucs2"||d==="ucs-2"||d==="utf16le"||d==="utf-16le")){if(o.length<2||a.length<2)return-1;S=2,C/=2,x/=2,c/=2}function H(O,F){return S===1?O[F]:O.readUInt16BE(F*S)}let M;if(m){let O=-1;for(M=c;M<C;M++)if(H(o,M)===H(a,O===-1?0:M-O)){if(O===-1&&(O=M),M-O+1===x)return O*S}else O!==-1&&(M-=M-O),O=-1}else for(c+x>C&&(c=C-x),M=c;M>=0;M--){let O=!0;for(let F=0;F<x;F++)if(H(o,M+F)!==H(a,F)){O=!1;break}if(O)return M}return-1}h.prototype.includes=function(o,a,c){return this.indexOf(o,a,c)!==-1},h.prototype.indexOf=function(o,a,c){return Ee(this,o,a,c,!0)},h.prototype.lastIndexOf=function(o,a,c){return Ee(this,o,a,c,!1)};function ht(o,a,c,d){c=Number(c)||0;const m=o.length-c;d?(d=Number(d),d>m&&(d=m)):d=m;const S=a.length;d>S/2&&(d=S/2);let C;for(C=0;C<d;++C){const x=parseInt(a.substr(C*2,2),16);if(dt(x))return C;o[c+C]=x}return C}function Te(o,a,c,d){return ze(pt(a,o.length-c),o,c,d)}function $e(o,a,c,d){return ze(fr(a),o,c,d)}function Ne(o,a,c,d){return ze(Vt(a),o,c,d)}function je(o,a,c,d){return ze(pr(a,o.length-c),o,c,d)}h.prototype.write=function(o,a,c,d){if(a===void 0)d="utf8",c=this.length,a=0;else if(c===void 0&&typeof a=="string")d=a,c=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(c)?(c=c>>>0,d===void 0&&(d="utf8")):(d=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const m=this.length-a;if((c===void 0||c>m)&&(c=m),o.length>0&&(c<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let S=!1;for(;;)switch(d){case"hex":return ht(this,o,a,c);case"utf8":case"utf-8":return Te(this,o,a,c);case"ascii":case"latin1":case"binary":return $e(this,o,a,c);case"base64":return Ne(this,o,a,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return je(this,o,a,c);default:if(S)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),S=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function rr(o,a,c){return a===0&&c===o.length?e.fromByteArray(o):e.fromByteArray(o.slice(a,c))}function Dt(o,a,c){c=Math.min(o.length,c);const d=[];let m=a;for(;m<c;){const S=o[m];let C=null,x=S>239?4:S>223?3:S>191?2:1;if(m+x<=c){let H,M,O,F;switch(x){case 1:S<128&&(C=S);break;case 2:H=o[m+1],(H&192)===128&&(F=(S&31)<<6|H&63,F>127&&(C=F));break;case 3:H=o[m+1],M=o[m+2],(H&192)===128&&(M&192)===128&&(F=(S&15)<<12|(H&63)<<6|M&63,F>2047&&(F<55296||F>57343)&&(C=F));break;case 4:H=o[m+1],M=o[m+2],O=o[m+3],(H&192)===128&&(M&192)===128&&(O&192)===128&&(F=(S&15)<<18|(H&63)<<12|(M&63)<<6|O&63,F>65535&&F<1114112&&(C=F))}}C===null?(C=65533,x=1):C>65535&&(C-=65536,d.push(C>>>10&1023|55296),C=56320|C&1023),d.push(C),m+=x}return or(d)}const $t=4096;function or(o){const a=o.length;if(a<=$t)return String.fromCharCode.apply(String,o);let c="",d=0;for(;d<a;)c+=String.fromCharCode.apply(String,o.slice(d,d+=$t));return c}function sr(o,a,c){let d="";c=Math.min(o.length,c);for(let m=a;m<c;++m)d+=String.fromCharCode(o[m]&127);return d}function ir(o,a,c){let d="";c=Math.min(o.length,c);for(let m=a;m<c;++m)d+=String.fromCharCode(o[m]);return d}function ar(o,a,c){const d=o.length;(!a||a<0)&&(a=0),(!c||c<0||c>d)&&(c=d);let m="";for(let S=a;S<c;++S)m+=dr[o[S]];return m}function lr(o,a,c){const d=o.slice(a,c);let m="";for(let S=0;S<d.length-1;S+=2)m+=String.fromCharCode(d[S]+d[S+1]*256);return m}h.prototype.slice=function(o,a){const c=this.length;o=~~o,a=a===void 0?c:~~a,o<0?(o+=c,o<0&&(o=0)):o>c&&(o=c),a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),a<o&&(a=o);const d=this.subarray(o,a);return Object.setPrototypeOf(d,h.prototype),d};function z(o,a,c){if(o%1!==0||o<0)throw new RangeError("offset is not uint");if(o+a>c)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUintLE=h.prototype.readUIntLE=function(o,a,c){o=o>>>0,a=a>>>0,c||z(o,a,this.length);let d=this[o],m=1,S=0;for(;++S<a&&(m*=256);)d+=this[o+S]*m;return d},h.prototype.readUintBE=h.prototype.readUIntBE=function(o,a,c){o=o>>>0,a=a>>>0,c||z(o,a,this.length);let d=this[o+--a],m=1;for(;a>0&&(m*=256);)d+=this[o+--a]*m;return d},h.prototype.readUint8=h.prototype.readUInt8=function(o,a){return o=o>>>0,a||z(o,1,this.length),this[o]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(o,a){return o=o>>>0,a||z(o,2,this.length),this[o]|this[o+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(o,a){return o=o>>>0,a||z(o,2,this.length),this[o]<<8|this[o+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(o,a){return o=o>>>0,a||z(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(o,a){return o=o>>>0,a||z(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},h.prototype.readBigUInt64LE=ue(function(o){o=o>>>0,be(o,"offset");const a=this[o],c=this[o+7];(a===void 0||c===void 0)&&Le(o,this.length-8);const d=a+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24,m=this[++o]+this[++o]*2**8+this[++o]*2**16+c*2**24;return BigInt(d)+(BigInt(m)<<BigInt(32))}),h.prototype.readBigUInt64BE=ue(function(o){o=o>>>0,be(o,"offset");const a=this[o],c=this[o+7];(a===void 0||c===void 0)&&Le(o,this.length-8);const d=a*2**24+this[++o]*2**16+this[++o]*2**8+this[++o],m=this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+c;return(BigInt(d)<<BigInt(32))+BigInt(m)}),h.prototype.readIntLE=function(o,a,c){o=o>>>0,a=a>>>0,c||z(o,a,this.length);let d=this[o],m=1,S=0;for(;++S<a&&(m*=256);)d+=this[o+S]*m;return m*=128,d>=m&&(d-=Math.pow(2,8*a)),d},h.prototype.readIntBE=function(o,a,c){o=o>>>0,a=a>>>0,c||z(o,a,this.length);let d=a,m=1,S=this[o+--d];for(;d>0&&(m*=256);)S+=this[o+--d]*m;return m*=128,S>=m&&(S-=Math.pow(2,8*a)),S},h.prototype.readInt8=function(o,a){return o=o>>>0,a||z(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},h.prototype.readInt16LE=function(o,a){o=o>>>0,a||z(o,2,this.length);const c=this[o]|this[o+1]<<8;return c&32768?c|4294901760:c},h.prototype.readInt16BE=function(o,a){o=o>>>0,a||z(o,2,this.length);const c=this[o+1]|this[o]<<8;return c&32768?c|4294901760:c},h.prototype.readInt32LE=function(o,a){return o=o>>>0,a||z(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},h.prototype.readInt32BE=function(o,a){return o=o>>>0,a||z(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},h.prototype.readBigInt64LE=ue(function(o){o=o>>>0,be(o,"offset");const a=this[o],c=this[o+7];(a===void 0||c===void 0)&&Le(o,this.length-8);const d=this[o+4]+this[o+5]*2**8+this[o+6]*2**16+(c<<24);return(BigInt(d)<<BigInt(32))+BigInt(a+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24)}),h.prototype.readBigInt64BE=ue(function(o){o=o>>>0,be(o,"offset");const a=this[o],c=this[o+7];(a===void 0||c===void 0)&&Le(o,this.length-8);const d=(a<<24)+this[++o]*2**16+this[++o]*2**8+this[++o];return(BigInt(d)<<BigInt(32))+BigInt(this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+c)}),h.prototype.readFloatLE=function(o,a){return o=o>>>0,a||z(o,4,this.length),t.read(this,o,!0,23,4)},h.prototype.readFloatBE=function(o,a){return o=o>>>0,a||z(o,4,this.length),t.read(this,o,!1,23,4)},h.prototype.readDoubleLE=function(o,a){return o=o>>>0,a||z(o,8,this.length),t.read(this,o,!0,52,8)},h.prototype.readDoubleBE=function(o,a){return o=o>>>0,a||z(o,8,this.length),t.read(this,o,!1,52,8)};function X(o,a,c,d,m,S){if(!h.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>m||a<S)throw new RangeError('"value" argument is out of bounds');if(c+d>o.length)throw new RangeError("Index out of range")}h.prototype.writeUintLE=h.prototype.writeUIntLE=function(o,a,c,d){if(o=+o,a=a>>>0,c=c>>>0,!d){const C=Math.pow(2,8*c)-1;X(this,o,a,c,C,0)}let m=1,S=0;for(this[a]=o&255;++S<c&&(m*=256);)this[a+S]=o/m&255;return a+c},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(o,a,c,d){if(o=+o,a=a>>>0,c=c>>>0,!d){const C=Math.pow(2,8*c)-1;X(this,o,a,c,C,0)}let m=c-1,S=1;for(this[a+m]=o&255;--m>=0&&(S*=256);)this[a+m]=o/S&255;return a+c},h.prototype.writeUint8=h.prototype.writeUInt8=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,1,255,0),this[a]=o&255,a+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,2,65535,0),this[a]=o&255,this[a+1]=o>>>8,a+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,2,65535,0),this[a]=o>>>8,this[a+1]=o&255,a+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,4,4294967295,0),this[a+3]=o>>>24,this[a+2]=o>>>16,this[a+1]=o>>>8,this[a]=o&255,a+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,4,4294967295,0),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4};function jt(o,a,c,d,m){Yt(a,d,m,o,c,7);let S=Number(a&BigInt(4294967295));o[c++]=S,S=S>>8,o[c++]=S,S=S>>8,o[c++]=S,S=S>>8,o[c++]=S;let C=Number(a>>BigInt(32)&BigInt(4294967295));return o[c++]=C,C=C>>8,o[c++]=C,C=C>>8,o[c++]=C,C=C>>8,o[c++]=C,c}function zt(o,a,c,d,m){Yt(a,d,m,o,c,7);let S=Number(a&BigInt(4294967295));o[c+7]=S,S=S>>8,o[c+6]=S,S=S>>8,o[c+5]=S,S=S>>8,o[c+4]=S;let C=Number(a>>BigInt(32)&BigInt(4294967295));return o[c+3]=C,C=C>>8,o[c+2]=C,C=C>>8,o[c+1]=C,C=C>>8,o[c]=C,c+8}h.prototype.writeBigUInt64LE=ue(function(o,a=0){return jt(this,o,a,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeBigUInt64BE=ue(function(o,a=0){return zt(this,o,a,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeIntLE=function(o,a,c,d){if(o=+o,a=a>>>0,!d){const x=Math.pow(2,8*c-1);X(this,o,a,c,x-1,-x)}let m=0,S=1,C=0;for(this[a]=o&255;++m<c&&(S*=256);)o<0&&C===0&&this[a+m-1]!==0&&(C=1),this[a+m]=(o/S>>0)-C&255;return a+c},h.prototype.writeIntBE=function(o,a,c,d){if(o=+o,a=a>>>0,!d){const x=Math.pow(2,8*c-1);X(this,o,a,c,x-1,-x)}let m=c-1,S=1,C=0;for(this[a+m]=o&255;--m>=0&&(S*=256);)o<0&&C===0&&this[a+m+1]!==0&&(C=1),this[a+m]=(o/S>>0)-C&255;return a+c},h.prototype.writeInt8=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,1,127,-128),o<0&&(o=255+o+1),this[a]=o&255,a+1},h.prototype.writeInt16LE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,2,32767,-32768),this[a]=o&255,this[a+1]=o>>>8,a+2},h.prototype.writeInt16BE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,2,32767,-32768),this[a]=o>>>8,this[a+1]=o&255,a+2},h.prototype.writeInt32LE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,4,2147483647,-2147483648),this[a]=o&255,this[a+1]=o>>>8,this[a+2]=o>>>16,this[a+3]=o>>>24,a+4},h.prototype.writeInt32BE=function(o,a,c){return o=+o,a=a>>>0,c||X(this,o,a,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4},h.prototype.writeBigInt64LE=ue(function(o,a=0){return jt(this,o,a,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeBigInt64BE=ue(function(o,a=0){return zt(this,o,a,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function qt(o,a,c,d,m,S){if(c+d>o.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function Wt(o,a,c,d,m){return a=+a,c=c>>>0,m||qt(o,a,c,4),t.write(o,a,c,d,23,4),c+4}h.prototype.writeFloatLE=function(o,a,c){return Wt(this,o,a,!0,c)},h.prototype.writeFloatBE=function(o,a,c){return Wt(this,o,a,!1,c)};function Ht(o,a,c,d,m){return a=+a,c=c>>>0,m||qt(o,a,c,8),t.write(o,a,c,d,52,8),c+8}h.prototype.writeDoubleLE=function(o,a,c){return Ht(this,o,a,!0,c)},h.prototype.writeDoubleBE=function(o,a,c){return Ht(this,o,a,!1,c)},h.prototype.copy=function(o,a,c,d){if(!h.isBuffer(o))throw new TypeError("argument should be a Buffer");if(c||(c=0),!d&&d!==0&&(d=this.length),a>=o.length&&(a=o.length),a||(a=0),d>0&&d<c&&(d=c),d===c||o.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),o.length-a<d-c&&(d=o.length-a+c);const m=d-c;return this===o&&typeof i.prototype.copyWithin=="function"?this.copyWithin(a,c,d):i.prototype.set.call(o,this.subarray(c,d),a),m},h.prototype.fill=function(o,a,c,d){if(typeof o=="string"){if(typeof a=="string"?(d=a,a=0,c=this.length):typeof c=="string"&&(d=c,c=this.length),d!==void 0&&typeof d!="string")throw new TypeError("encoding must be a string");if(typeof d=="string"&&!h.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(o.length===1){const S=o.charCodeAt(0);(d==="utf8"&&S<128||d==="latin1")&&(o=S)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(a<0||this.length<a||this.length<c)throw new RangeError("Out of range index");if(c<=a)return this;a=a>>>0,c=c===void 0?this.length:c>>>0,o||(o=0);let m;if(typeof o=="number")for(m=a;m<c;++m)this[m]=o;else{const S=h.isBuffer(o)?o:h.from(o,d),C=S.length;if(C===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(m=0;m<c-a;++m)this[m+a]=S[m%C]}return this};const ye={};function ft(o,a,c){ye[o]=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:a.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${o}]`,this.stack,delete this.name}get code(){return o}set code(d){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:d,writable:!0})}toString(){return`${this.name} [${o}]: ${this.message}`}}}ft("ERR_BUFFER_OUT_OF_BOUNDS",function(o){return o?`${o} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ft("ERR_INVALID_ARG_TYPE",function(o,a){return`The "${o}" argument must be of type number. Received type ${typeof a}`},TypeError),ft("ERR_OUT_OF_RANGE",function(o,a,c){let d=`The value of "${o}" is out of range.`,m=c;return Number.isInteger(c)&&Math.abs(c)>2**32?m=Kt(String(c)):typeof c=="bigint"&&(m=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(m=Kt(m)),m+="n"),d+=` It must be ${a}. Received ${m}`,d},RangeError);function Kt(o){let a="",c=o.length;const d=o[0]==="-"?1:0;for(;c>=d+4;c-=3)a=`_${o.slice(c-3,c)}${a}`;return`${o.slice(0,c)}${a}`}function cr(o,a,c){be(a,"offset"),(o[a]===void 0||o[a+c]===void 0)&&Le(a,o.length-(c+1))}function Yt(o,a,c,d,m,S){if(o>c||o<a){const C=typeof a=="bigint"?"n":"";let x;throw a===0||a===BigInt(0)?x=`>= 0${C} and < 2${C} ** ${(S+1)*8}${C}`:x=`>= -(2${C} ** ${(S+1)*8-1}${C}) and < 2 ** ${(S+1)*8-1}${C}`,new ye.ERR_OUT_OF_RANGE("value",x,o)}cr(d,m,S)}function be(o,a){if(typeof o!="number")throw new ye.ERR_INVALID_ARG_TYPE(a,"number",o)}function Le(o,a,c){throw Math.floor(o)!==o?(be(o,c),new ye.ERR_OUT_OF_RANGE("offset","an integer",o)):a<0?new ye.ERR_BUFFER_OUT_OF_BOUNDS:new ye.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${a}`,o)}const ur=/[^+/0-9A-Za-z-_]/g;function hr(o){if(o=o.split("=")[0],o=o.trim().replace(ur,""),o.length<2)return"";for(;o.length%4!==0;)o=o+"=";return o}function pt(o,a){a=a||1/0;let c;const d=o.length;let m=null;const S=[];for(let C=0;C<d;++C){if(c=o.charCodeAt(C),c>55295&&c<57344){if(!m){if(c>56319){(a-=3)>-1&&S.push(239,191,189);continue}else if(C+1===d){(a-=3)>-1&&S.push(239,191,189);continue}m=c;continue}if(c<56320){(a-=3)>-1&&S.push(239,191,189),m=c;continue}c=(m-55296<<10|c-56320)+65536}else m&&(a-=3)>-1&&S.push(239,191,189);if(m=null,c<128){if((a-=1)<0)break;S.push(c)}else if(c<2048){if((a-=2)<0)break;S.push(c>>6|192,c&63|128)}else if(c<65536){if((a-=3)<0)break;S.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((a-=4)<0)break;S.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return S}function fr(o){const a=[];for(let c=0;c<o.length;++c)a.push(o.charCodeAt(c)&255);return a}function pr(o,a){let c,d,m;const S=[];for(let C=0;C<o.length&&!((a-=2)<0);++C)c=o.charCodeAt(C),d=c>>8,m=c%256,S.push(m),S.push(d);return S}function Vt(o){return e.toByteArray(hr(o))}function ze(o,a,c,d){let m;for(m=0;m<d&&!(m+c>=a.length||m>=o.length);++m)a[m+c]=o[m];return m}function ne(o,a){return o instanceof a||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===a.name}function dt(o){return o!==o}const dr=function(){const o="0123456789abcdef",a=new Array(256);for(let c=0;c<16;++c){const d=c*16;for(let m=0;m<16;++m)a[d+m]=o[c]+o[m]}return a}();function ue(o){return typeof BigInt>"u"?gr:o}function gr(){throw new Error("BigInt not supported")}})(tn);const Pe=tn.Buffer;var te;(function(r){r[r.NotSet=-1]="NotSet",r[r.None=0]="None",r[r.Italic=1]="Italic",r[r.Bold=2]="Bold",r[r.Underline=4]="Underline"})(te||(te={}));var Se;(function(r){function e(h){return h.toString(2).padStart(32,"0")}r.toBinaryStr=e;function t(h){const y=r.getLanguageId(h),b=r.getTokenType(h),w=r.getFontStyle(h),k=r.getForeground(h),_=r.getBackground(h)}r.print=t;function n(h){return(h&255)>>>0}r.getLanguageId=n;function s(h){return(h&768)>>>8}r.getTokenType=s;function i(h){return(h&1024)!==0}r.containsBalancedBrackets=i;function l(h){return(h&30720)>>>11}r.getFontStyle=l;function f(h){return(h&16744448)>>>15}r.getForeground=f;function u(h){return(h&4278190080)>>>24}r.getBackground=u;function p(h,y,b,w,k,_,A){let N=r.getLanguageId(h),P=r.getTokenType(h),E=r.containsBalancedBrackets(h)?1:0,T=r.getFontStyle(h),L=r.getForeground(h),R=r.getBackground(h);return y!==0&&(N=y),b!==8&&(P=b),w!==null&&(E=w?1:0),k!==-1&&(T=k),_!==0&&(L=_),A!==0&&(R=A),(N<<0|P<<8|E<<10|T<<11|L<<15|R<<24)>>>0}r.set=p})(Se||(Se={}));function He(r,e){const t=[],n=Br(r);let s=n.next();for(;s!==null;){let u=0;if(s.length===2&&s.charAt(1)===":"){switch(s.charAt(0)){case"R":u=1;break;case"L":u=-1;break;default:}s=n.next()}let p=l();if(t.push({matcher:p,priority:u}),s!==",")break;s=n.next()}return t;function i(){if(s==="-"){s=n.next();const u=i();return p=>!!u&&!u(p)}if(s==="("){s=n.next();const u=f();return s===")"&&(s=n.next()),u}if(rn(s)){const u=[];do u.push(s),s=n.next();while(rn(s));return p=>e(u,p)}return null}function l(){const u=[];let p=i();for(;p;)u.push(p),p=i();return h=>u.every(y=>y(h))}function f(){const u=[];let p=l();for(;p&&(u.push(p),s==="|"||s===",");){do s=n.next();while(s==="|"||s===",");p=l()}return h=>u.some(y=>y(h))}}function rn(r){return!!r&&!!r.match(/[\w\.:]+/)}function Br(r){let e=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,t=e.exec(r);return{next:()=>{if(!t)return null;const n=t[0];return t=e.exec(r),n}}}function on(r){typeof r.dispose=="function"&&r.dispose()}function xr(r){return _t(r)}function _t(r){return Array.isArray(r)?Mr(r):typeof r=="object"?Ur(r):r}function Mr(r){let e=[];for(let t=0,n=r.length;t<n;t++)e[t]=_t(r[t]);return e}function Ur(r){let e={};for(let t in r)e[t]=_t(r[t]);return e}function sn(r,...e){return e.forEach(t=>{for(let n in t)r[n]=t[n]}),r}function an(r){const e=~r.lastIndexOf("/")||~r.lastIndexOf("\\");return e===0?r:~e===r.length-1?an(r.substring(0,r.length-1)):r.substr(~e+1)}let wt=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;class Ke{static hasCaptures(e){return e===null?!1:(wt.lastIndex=0,wt.test(e))}static replaceCaptures(e,t,n){return e.replace(wt,(s,i,l,f)=>{let u=n[parseInt(i||l,10)];if(u){let p=t.substring(u.start,u.end);for(;p[0]===".";)p=p.substring(1);switch(f){case"downcase":return p.toLowerCase();case"upcase":return p.toUpperCase();default:return p}}else return s})}}function ln(r,e){return r<e?-1:r>e?1:0}function cn(r,e){if(r===null&&e===null)return 0;if(!r)return-1;if(!e)return 1;let t=r.length,n=e.length;if(t===n){for(let s=0;s<t;s++){let i=ln(r[s],e[s]);if(i!==0)return i}return 0}return t-n}function un(r){return!!(/^#[0-9a-f]{6}$/i.test(r)||/^#[0-9a-f]{8}$/i.test(r)||/^#[0-9a-f]{3}$/i.test(r)||/^#[0-9a-f]{4}$/i.test(r))}function hn(r){return r.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}class fn{constructor(e){g(this,"fn");g(this,"cache",new Map);this.fn=e}get(e){if(this.cache.has(e))return this.cache.get(e);const t=this.fn(e);return this.cache.set(e,t),t}}class Re{constructor(e){g(this,"scopeName");this.scopeName=e}toKey(){return this.scopeName}}class Gr{constructor(e,t){g(this,"scopeName");g(this,"ruleName");this.scopeName=e,this.ruleName=t}toKey(){return`${this.scopeName}#${this.ruleName}`}}class Fr{constructor(){g(this,"_references",[]);g(this,"_seenReferenceKeys",new Set);g(this,"visitedRule",new Set)}get references(){return this._references}add(e){const t=e.toKey();this._seenReferenceKeys.has(t)||(this._seenReferenceKeys.add(t),this._references.push(e))}}class Dr{constructor(e,t){g(this,"repo");g(this,"initialScopeName");g(this,"seenFullScopeRequests",new Set);g(this,"seenPartialScopeRequests",new Set);g(this,"Q");this.repo=e,this.initialScopeName=t,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new Re(this.initialScopeName)]}processQueue(){const e=this.Q;this.Q=[];const t=new Fr;for(const n of e)$r(n,this.initialScopeName,this.repo,t);for(const n of t.references)if(n instanceof Re){if(this.seenFullScopeRequests.has(n.scopeName))continue;this.seenFullScopeRequests.add(n.scopeName),this.Q.push(n)}else{if(this.seenFullScopeRequests.has(n.scopeName)||this.seenPartialScopeRequests.has(n.toKey()))continue;this.seenPartialScopeRequests.add(n.toKey()),this.Q.push(n)}}}function $r(r,e,t,n){const s=t.lookup(r.scopeName);if(!s){if(r.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const i=t.lookup(e);r instanceof Re?Ye({baseGrammar:i,selfGrammar:s},n):St(r.ruleName,{baseGrammar:i,selfGrammar:s,repository:s.repository},n);const l=t.injections(r.scopeName);if(l)for(const f of l)n.add(new Re(f))}function St(r,e,t){if(e.repository&&e.repository[r]){const n=e.repository[r];Ve([n],e,t)}}function Ye(r,e){r.selfGrammar.patterns&&Array.isArray(r.selfGrammar.patterns)&&Ve(r.selfGrammar.patterns,{...r,repository:r.selfGrammar.repository},e),r.selfGrammar.injections&&Ve(Object.values(r.selfGrammar.injections),{...r,repository:r.selfGrammar.repository},e)}function Ve(r,e,t){for(const n of r){if(t.visitedRule.has(n))continue;t.visitedRule.add(n);const s=n.repository?sn({},e.repository,n.repository):e.repository;Array.isArray(n.patterns)&&Ve(n.patterns,{...e,repository:s},t);const i=n.include;if(!i)continue;const l=pn(i);switch(l.kind){case 0:Ye({...e,selfGrammar:e.baseGrammar},t);break;case 1:Ye(e,t);break;case 2:St(l.ruleName,{...e,repository:s},t);break;case 3:case 4:const f=l.scopeName===e.selfGrammar.scopeName?e.selfGrammar:l.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(f){const u={baseGrammar:e.baseGrammar,selfGrammar:f,repository:s};l.kind===4?St(l.ruleName,u,t):Ye(u,t)}else l.kind===4?t.add(new Gr(l.scopeName,l.ruleName)):t.add(new Re(l.scopeName));break}}}class jr{constructor(){g(this,"kind",0)}}class zr{constructor(){g(this,"kind",1)}}class qr{constructor(e){g(this,"ruleName");g(this,"kind",2);this.ruleName=e}}class Wr{constructor(e){g(this,"scopeName");g(this,"kind",3);this.scopeName=e}}class Hr{constructor(e,t){g(this,"scopeName");g(this,"ruleName");g(this,"kind",4);this.scopeName=e,this.ruleName=t}}function pn(r){if(r==="$base")return new jr;if(r==="$self")return new zr;const e=r.indexOf("#");if(e===-1)return new Wr(r);if(e===0)return new qr(r.substring(1));{const t=r.substring(0,e),n=r.substring(e+1);return new Hr(t,n)}}const Kr=/\\(\d+)/,dn=/\\(\d+)/g,Yr=-1,gn=-2;class Ie{constructor(e,t,n,s){g(this,"$location");g(this,"id");g(this,"_nameIsCapturing");g(this,"_name");g(this,"_contentNameIsCapturing");g(this,"_contentName");this.$location=e,this.id=t,this._name=n||null,this._nameIsCapturing=Ke.hasCaptures(this._name),this._contentName=s||null,this._contentNameIsCapturing=Ke.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${an(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,t){return!this._nameIsCapturing||this._name===null||e===null||t===null?this._name:Ke.replaceCaptures(this._name,e,t)}getContentName(e,t){return!this._contentNameIsCapturing||this._contentName===null?this._contentName:Ke.replaceCaptures(this._contentName,e,t)}}class Vr extends Ie{constructor(t,n,s,i,l){super(t,n,s,i);g(this,"retokenizeCapturedWithRuleId");this.retokenizeCapturedWithRuleId=l}dispose(){}collectPatterns(t,n){throw new Error("Not supported!")}compile(t,n){throw new Error("Not supported!")}compileAG(t,n,s,i){throw new Error("Not supported!")}}class Xr extends Ie{constructor(t,n,s,i,l){super(t,n,s,null);g(this,"_match");g(this,"captures");g(this,"_cachedCompiledPatterns");this._match=new ge(i,this.id),this.captures=l,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(t,n){n.push(this._match)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,s,i){return this._getCachedCompiledPatterns(t).compileAG(t,s,i)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new Oe,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}class mn extends Ie{constructor(t,n,s,i,l){super(t,n,s,i);g(this,"hasMissingPatterns");g(this,"patterns");g(this,"_cachedCompiledPatterns");this.patterns=l.patterns,this.hasMissingPatterns=l.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(t,n){for(const s of this.patterns)t.getRule(s).collectPatterns(t,n)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,s,i){return this._getCachedCompiledPatterns(t).compileAG(t,s,i)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new Oe,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}class kt extends Ie{constructor(t,n,s,i,l,f,u,p,h,y){super(t,n,s,i);g(this,"_begin");g(this,"beginCaptures");g(this,"_end");g(this,"endHasBackReferences");g(this,"endCaptures");g(this,"applyEndPatternLast");g(this,"hasMissingPatterns");g(this,"patterns");g(this,"_cachedCompiledPatterns");this._begin=new ge(l,this.id),this.beginCaptures=f,this._end=new ge(u||"\uFFFF",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=p,this.applyEndPatternLast=h||!1,this.patterns=y.patterns,this.hasMissingPatterns=y.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(t,n){return this._end.resolveBackReferences(t,n)}collectPatterns(t,n){n.push(this._begin)}compile(t,n){return this._getCachedCompiledPatterns(t,n).compile(t)}compileAG(t,n,s,i){return this._getCachedCompiledPatterns(t,n).compileAG(t,s,i)}_getCachedCompiledPatterns(t,n){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new Oe;for(const s of this.patterns)t.getRule(s).collectPatterns(t,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,n):this._cachedCompiledPatterns.setSource(0,n)),this._cachedCompiledPatterns}}class Xe extends Ie{constructor(t,n,s,i,l,f,u,p,h){super(t,n,s,i);g(this,"_begin");g(this,"beginCaptures");g(this,"whileCaptures");g(this,"_while");g(this,"whileHasBackReferences");g(this,"hasMissingPatterns");g(this,"patterns");g(this,"_cachedCompiledPatterns");g(this,"_cachedCompiledWhilePatterns");this._begin=new ge(l,this.id),this.beginCaptures=f,this.whileCaptures=p,this._while=new ge(u,gn),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=h.patterns,this.hasMissingPatterns=h.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(t,n){return this._while.resolveBackReferences(t,n)}collectPatterns(t,n){n.push(this._begin)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,s,i){return this._getCachedCompiledPatterns(t).compileAG(t,s,i)}_getCachedCompiledPatterns(t){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new Oe;for(const n of this.patterns)t.getRule(n).collectPatterns(t,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(t,n){return this._getCachedCompiledWhilePatterns(t,n).compile(t)}compileWhileAG(t,n,s,i){return this._getCachedCompiledWhilePatterns(t,n).compileAG(t,s,i)}_getCachedCompiledWhilePatterns(t,n){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new Oe,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,n||"\uFFFF"),this._cachedCompiledWhilePatterns}}class W{static createCaptureRule(e,t,n,s,i){return e.registerRule(l=>new Vr(t,l,n,s,i))}static getCompiledRuleId(e,t,n){return e.id||t.registerRule(s=>{if(e.id=s,e.match)return new Xr(e.$vscodeTextmateLocation,e.id,e.name,e.match,W._compileCaptures(e.captures,t,n));if(typeof e.begin>"u"){e.repository&&(n=sn({},n,e.repository));let i=e.patterns;return typeof i>"u"&&e.include&&(i=[{include:e.include}]),new mn(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,W._compilePatterns(i,t,n))}return e.while?new Xe(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,W._compileCaptures(e.beginCaptures||e.captures,t,n),e.while,W._compileCaptures(e.whileCaptures||e.captures,t,n),W._compilePatterns(e.patterns,t,n)):new kt(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,W._compileCaptures(e.beginCaptures||e.captures,t,n),e.end,W._compileCaptures(e.endCaptures||e.captures,t,n),e.applyEndPatternLast,W._compilePatterns(e.patterns,t,n))}),e.id}static _compileCaptures(e,t,n){let s=[];if(e){let i=0;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const f=parseInt(l,10);f>i&&(i=f)}for(let l=0;l<=i;l++)s[l]=null;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const f=parseInt(l,10);let u=0;e[l].patterns&&(u=W.getCompiledRuleId(e[l],t,n)),s[f]=W.createCaptureRule(t,e[l].$vscodeTextmateLocation,e[l].name,e[l].contentName,u)}}return s}static _compilePatterns(e,t,n){let s=[];if(e)for(let i=0,l=e.length;i<l;i++){const f=e[i];let u=-1;if(f.include){const p=pn(f.include);switch(p.kind){case 0:case 1:u=W.getCompiledRuleId(n[f.include],t,n);break;case 2:let h=n[p.ruleName];h&&(u=W.getCompiledRuleId(h,t,n));break;case 3:case 4:const y=p.scopeName,b=p.kind===4?p.ruleName:null,w=t.getExternalGrammar(y,n);if(w)if(b){let k=w.repository[b];k&&(u=W.getCompiledRuleId(k,t,w.repository))}else u=W.getCompiledRuleId(w.repository.$self,t,w.repository);break}}else u=W.getCompiledRuleId(f,t,n);if(u!==-1){const p=t.getRule(u);let h=!1;if((p instanceof mn||p instanceof kt||p instanceof Xe)&&p.hasMissingPatterns&&p.patterns.length===0&&(h=!0),h)continue;s.push(u)}}return{patterns:s,hasMissingPatterns:(e?e.length:0)!==s.length}}}class ge{constructor(e,t){g(this,"source");g(this,"ruleId");g(this,"hasAnchor");g(this,"hasBackReferences");g(this,"_anchorCache");if(e){const n=e.length;let s=0,i=[],l=!1;for(let f=0;f<n;f++)if(e.charAt(f)==="\\"&&f+1<n){const u=e.charAt(f+1);u==="z"?(i.push(e.substring(s,f)),i.push("$(?!\\n)(?<!\\n)"),s=f+2):(u==="A"||u==="G")&&(l=!0),f++}this.hasAnchor=l,s===0?this.source=e:(i.push(e.substring(s,n)),this.source=i.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=t,this.hasBackReferences=Kr.test(this.source)}clone(){return new ge(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,t){let n=t.map(s=>e.substring(s.start,s.end));return dn.lastIndex=0,this.source.replace(dn,(s,i)=>hn(n[parseInt(i,10)]||""))}_buildAnchorCache(){let e=[],t=[],n=[],s=[],i,l,f,u;for(i=0,l=this.source.length;i<l;i++)f=this.source.charAt(i),e[i]=f,t[i]=f,n[i]=f,s[i]=f,f==="\\"&&i+1<l&&(u=this.source.charAt(i+1),u==="A"?(e[i+1]="\uFFFF",t[i+1]="\uFFFF",n[i+1]="A",s[i+1]="A"):u==="G"?(e[i+1]="\uFFFF",t[i+1]="G",n[i+1]="\uFFFF",s[i+1]="G"):(e[i+1]=u,t[i+1]=u,n[i+1]=u,s[i+1]=u),i++);return{A0_G0:e.join(""),A0_G1:t.join(""),A1_G0:n.join(""),A1_G1:s.join("")}}resolveAnchors(e,t){return!this.hasAnchor||!this._anchorCache?this.source:e?t?this._anchorCache.A1_G1:this._anchorCache.A1_G0:t?this._anchorCache.A0_G1:this._anchorCache.A0_G0}}class Oe{constructor(){g(this,"_items");g(this,"_hasAnchors");g(this,"_cached");g(this,"_anchorCache");this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,t){this._items[e].source!==t&&(this._disposeCaches(),this._items[e].setSource(t))}compile(e){if(!this._cached){let t=this._items.map(n=>n.source);this._cached=new yn(e,t,this._items.map(n=>n.ruleId))}return this._cached}compileAG(e,t,n){return this._hasAnchors?t?n?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,t,n)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,t,n)),this._anchorCache.A1_G0):n?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,t,n)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,t,n)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,t,n){let s=this._items.map(i=>i.resolveAnchors(t,n));return new yn(e,s,this._items.map(i=>i.ruleId))}}class yn{constructor(e,t,n){g(this,"regExps");g(this,"rules");g(this,"scanner");this.regExps=t,this.rules=n,this.scanner=e.createOnigScanner(t)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let t=0,n=this.rules.length;t<n;t++)e.push("   - "+this.rules[t]+": "+this.regExps[t]);return e.join(`
`)}findNextMatchSync(e,t,n){const s=this.scanner.findNextMatchSync(e,t,n);return s?{ruleId:this.rules[s.index],captureIndices:s.captureIndices}:null}}class Je{constructor(e,t,n){g(this,"_colorMap");g(this,"_defaults");g(this,"_root");g(this,"_cachedMatchRoot",new fn(e=>this._root.match(e)));this._colorMap=e,this._defaults=t,this._root=n}static createFromRawTheme(e,t){return this.createFromParsedTheme(Zr(e),t)}static createFromParsedTheme(e,t){return to(e,t)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(e){if(e===null)return this._defaults;const t=e.scopeName,n=this._cachedMatchRoot.get(t).find(s=>Jr(e.parent,s.parentScopes));return n?new bn(n.fontStyle,n.foreground,n.background):null}}class me{constructor(e,t){g(this,"parent");g(this,"scopeName");this.parent=e,this.scopeName=t}static push(e,t){for(const n of t)e=new me(e,n);return e}static from(...e){let t=null;for(let n=0;n<e.length;n++)t=new me(t,e[n]);return t}push(e){return new me(this,e)}getSegments(){let e=this;const t=[];for(;e;)t.push(e.scopeName),e=e.parent;return t.reverse(),t}toString(){return this.getSegments().join(" ")}extends(e){return this===e?!0:this.parent===null?!1:this.parent.extends(e)}getExtensionIfDefined(e){const t=[];let n=this;for(;n&&n!==e;)t.push(n.scopeName),n=n.parent;return n===e?t.reverse():void 0}}function Jr(r,e){if(e===null)return!0;let t=0,n=e[t];for(;r;){if(Qr(r.scopeName,n)){if(t++,t===e.length)return!0;n=e[t]}r=r.parent}return!1}function Qr(r,e){return e===r||r.startsWith(e)&&r[e.length]==="."}class bn{constructor(e,t,n){g(this,"fontStyle");g(this,"foregroundId");g(this,"backgroundId");this.fontStyle=e,this.foregroundId=t,this.backgroundId=n}}function Zr(r){if(!r)return[];if(!r.settings||!Array.isArray(r.settings))return[];let e=r.settings,t=[],n=0;for(let s=0,i=e.length;s<i;s++){let l=e[s];if(!l.settings)continue;let f;if(typeof l.scope=="string"){let y=l.scope;y=y.replace(/^[,]+/,""),y=y.replace(/[,]+$/,""),f=y.split(",")}else Array.isArray(l.scope)?f=l.scope:f=[""];let u=-1;if(typeof l.settings.fontStyle=="string"){u=0;let y=l.settings.fontStyle.split(" ");for(let b=0,w=y.length;b<w;b++)switch(y[b]){case"italic":u=u|1;break;case"bold":u=u|2;break;case"underline":u=u|4;break;case"strikethrough":u=u|8;break}}let p=null;typeof l.settings.foreground=="string"&&un(l.settings.foreground)&&(p=l.settings.foreground);let h=null;typeof l.settings.background=="string"&&un(l.settings.background)&&(h=l.settings.background);for(let y=0,b=f.length;y<b;y++){let w=f[y].trim().split(" "),k=w[w.length-1],_=null;w.length>1&&(_=w.slice(0,w.length-1),_.reverse()),t[n++]=new eo(k,_,s,u,p,h)}}return t}class eo{constructor(e,t,n,s,i,l){g(this,"scope");g(this,"parentScopes");g(this,"index");g(this,"fontStyle");g(this,"foreground");g(this,"background");this.scope=e,this.parentScopes=t,this.index=n,this.fontStyle=s,this.foreground=i,this.background=l}}function to(r,e){r.sort((u,p)=>{let h=ln(u.scope,p.scope);return h!==0||(h=cn(u.parentScopes,p.parentScopes),h!==0)?h:u.index-p.index});let t=0,n="#000000",s="#ffffff";for(;r.length>=1&&r[0].scope==="";){let u=r.shift();u.fontStyle!==-1&&(t=u.fontStyle),u.foreground!==null&&(n=u.foreground),u.background!==null&&(s=u.background)}let i=new no(e),l=new bn(t,i.getId(n),i.getId(s)),f=new Ge(new Ue(0,null,-1,0,0),[]);for(let u=0,p=r.length;u<p;u++){let h=r[u];f.insert(0,h.scope,h.parentScopes,h.fontStyle,i.getId(h.foreground),i.getId(h.background))}return new Je(i,l,f)}class no{constructor(e){g(this,"_isFrozen");g(this,"_lastColorId");g(this,"_id2color");g(this,"_color2id");if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(e)){this._isFrozen=!0;for(let t=0,n=e.length;t<n;t++)this._color2id[e[t]]=t,this._id2color[t]=e[t]}else this._isFrozen=!1}getId(e){if(e===null)return 0;e=e.toUpperCase();let t=this._color2id[e];if(t)return t;if(this._isFrozen)throw new Error(`Missing color in color map - ${e}`);return t=++this._lastColorId,this._color2id[e]=t,this._id2color[t]=e,t}getColorMap(){return this._id2color.slice(0)}}class Ue{constructor(e,t,n,s,i){g(this,"scopeDepth");g(this,"parentScopes");g(this,"fontStyle");g(this,"foreground");g(this,"background");this.scopeDepth=e,this.parentScopes=t,this.fontStyle=n,this.foreground=s,this.background=i}clone(){return new Ue(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(e){let t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n].clone();return t}acceptOverwrite(e,t,n,s){this.scopeDepth>e||(this.scopeDepth=e),t!==-1&&(this.fontStyle=t),n!==0&&(this.foreground=n),s!==0&&(this.background=s)}}class Ge{constructor(e,t=[],n={}){g(this,"_mainRule");g(this,"_children");g(this,"_rulesWithParentScopes");this._mainRule=e,this._children=n,this._rulesWithParentScopes=t}static _sortBySpecificity(e){return e.length===1||e.sort(this._cmpBySpecificity),e}static _cmpBySpecificity(e,t){if(e.scopeDepth===t.scopeDepth){const n=e.parentScopes,s=t.parentScopes;let i=n===null?0:n.length,l=s===null?0:s.length;if(i===l)for(let f=0;f<i;f++){const u=n[f].length,p=s[f].length;if(u!==p)return p-u}return l-i}return t.scopeDepth-e.scopeDepth}match(e){if(e==="")return Ge._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let t=e.indexOf("."),n,s;return t===-1?(n=e,s=""):(n=e.substring(0,t),s=e.substring(t+1)),this._children.hasOwnProperty(n)?this._children[n].match(s):Ge._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(e,t,n,s,i,l){if(t===""){this._doInsertHere(e,n,s,i,l);return}let f=t.indexOf("."),u,p;f===-1?(u=t,p=""):(u=t.substring(0,f),p=t.substring(f+1));let h;this._children.hasOwnProperty(u)?h=this._children[u]:(h=new Ge(this._mainRule.clone(),Ue.cloneArr(this._rulesWithParentScopes)),this._children[u]=h),h.insert(e+1,p,n,s,i,l)}_doInsertHere(e,t,n,s,i){if(t===null){this._mainRule.acceptOverwrite(e,n,s,i);return}for(let l=0,f=this._rulesWithParentScopes.length;l<f;l++){let u=this._rulesWithParentScopes[l];if(cn(u.parentScopes,t)===0){u.acceptOverwrite(e,n,s,i);return}}n===-1&&(n=this._mainRule.fontStyle),s===0&&(s=this._mainRule.foreground),i===0&&(i=this._mainRule.background),this._rulesWithParentScopes.push(new Ue(e,t,n,s,i))}}class vt{constructor(e,t){g(this,"languageId");g(this,"tokenType");this.languageId=e,this.tokenType=t}}const Ae=class Ae{constructor(e,t){g(this,"_defaultAttributes");g(this,"_embeddedLanguagesMatcher");g(this,"_getBasicScopeAttributes",new fn(e=>{const t=this._scopeToLanguage(e),n=this._toStandardTokenType(e);return new vt(t,n)}));this._defaultAttributes=new vt(e,8),this._embeddedLanguagesMatcher=new ro(Object.entries(t||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(e){return e===null?Ae._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(e)}_scopeToLanguage(e){return this._embeddedLanguagesMatcher.match(e)||0}_toStandardTokenType(e){const t=e.match(Ae.STANDARD_TOKEN_TYPE_REGEXP);if(!t)return 8;switch(t[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}};g(Ae,"_NULL_SCOPE_METADATA",new vt(0,0)),g(Ae,"STANDARD_TOKEN_TYPE_REGEXP",/\b(comment|string|regex|meta\.embedded)\b/);let Ct=Ae;class ro{constructor(e){g(this,"values");g(this,"scopesRegExp");if(e.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(e);const t=e.map(([n,s])=>hn(n));t.sort(),t.reverse(),this.scopesRegExp=new RegExp(`^((${t.join(")|(")}))($|\\.)`,"")}}match(e){if(!this.scopesRegExp)return;const t=e.match(this.scopesRegExp);if(t)return this.values.get(t[1])}}class _n{constructor(e,t){g(this,"stack");g(this,"stoppedEarly");this.stack=e,this.stoppedEarly=t}}function wn(r,e,t,n,s,i,l,f){const u=e.content.length;let p=!1,h=-1;if(l){const w=oo(r,e,t,n,s,i);s=w.stack,n=w.linePos,t=w.isFirstLine,h=w.anchorPosition}const y=Date.now();for(;!p;){if(f!==0&&Date.now()-y>f)return new _n(s,!0);b()}return new _n(s,!1);function b(){const w=so(r,e,t,n,s,h);if(!w){i.produce(s,u),p=!0;return}const k=w.captureIndices,_=w.matchedRuleId,A=k&&k.length>0?k[0].end>n:!1;if(_===Yr){const N=s.getRule(r);i.produce(s,k[0].start),s=s.withContentNameScopesList(s.nameScopesList),Be(r,e,t,s,i,N.endCaptures,k),i.produce(s,k[0].end);const P=s;if(s=s.parent,h=P.getAnchorPos(),!A&&P.getEnterPos()===n){s=P,i.produce(s,u),p=!0;return}}else{const N=r.getRule(_);i.produce(s,k[0].start);const P=s,E=N.getName(e.content,k),T=s.contentNameScopesList.pushAttributed(E,r);if(s=s.push(_,n,h,k[0].end===u,null,T,T),N instanceof kt){const L=N;Be(r,e,t,s,i,L.beginCaptures,k),i.produce(s,k[0].end),h=k[0].end;const R=L.getContentName(e.content,k),Y=T.pushAttributed(R,r);if(s=s.withContentNameScopesList(Y),L.endHasBackReferences&&(s=s.withEndRule(L.getEndWithResolvedBackReferences(e.content,k))),!A&&P.hasSameRuleAs(s)){s=s.pop(),i.produce(s,u),p=!0;return}}else if(N instanceof Xe){const L=N;Be(r,e,t,s,i,L.beginCaptures,k),i.produce(s,k[0].end),h=k[0].end;const R=L.getContentName(e.content,k),Y=T.pushAttributed(R,r);if(s=s.withContentNameScopesList(Y),L.whileHasBackReferences&&(s=s.withEndRule(L.getWhileWithResolvedBackReferences(e.content,k))),!A&&P.hasSameRuleAs(s)){s=s.pop(),i.produce(s,u),p=!0;return}}else if(Be(r,e,t,s,i,N.captures,k),i.produce(s,k[0].end),s=s.pop(),!A){s=s.safePop(),i.produce(s,u),p=!0;return}}k[0].end>n&&(n=k[0].end,t=!1)}}function oo(r,e,t,n,s,i){let l=s.beginRuleCapturedEOL?0:-1;const f=[];for(let u=s;u;u=u.pop()){const p=u.getRule(r);p instanceof Xe&&f.push({rule:p,stack:u})}for(let u=f.pop();u;u=f.pop()){const{ruleScanner:p,findOptions:h}=lo(u.rule,r,u.stack.endRule,t,n===l),y=p.findNextMatchSync(e,n,h);if(y){if(y.ruleId!==gn){s=u.stack.pop();break}y.captureIndices&&y.captureIndices.length&&(i.produce(u.stack,y.captureIndices[0].start),Be(r,e,t,u.stack,i,u.rule.whileCaptures,y.captureIndices),i.produce(u.stack,y.captureIndices[0].end),l=y.captureIndices[0].end,y.captureIndices[0].end>n&&(n=y.captureIndices[0].end,t=!1))}else{s=u.stack.pop();break}}return{stack:s,linePos:n,anchorPosition:l,isFirstLine:t}}function so(r,e,t,n,s,i){const l=io(r,e,t,n,s,i),f=r.getInjections();if(f.length===0)return l;const u=ao(f,r,e,t,n,s,i);if(!u)return l;if(!l)return u;const p=l.captureIndices[0].start,h=u.captureIndices[0].start;return h<p||u.priorityMatch&&h===p?u:l}function io(r,e,t,n,s,i){const l=s.getRule(r),{ruleScanner:f,findOptions:u}=Sn(l,r,s.endRule,t,n===i),p=f.findNextMatchSync(e,n,u);return p?{captureIndices:p.captureIndices,matchedRuleId:p.ruleId}:null}function ao(r,e,t,n,s,i,l){let f=Number.MAX_VALUE,u=null,p,h=0;const y=i.contentNameScopesList.getScopeNames();for(let b=0,w=r.length;b<w;b++){const k=r[b];if(!k.matcher(y))continue;const _=e.getRule(k.ruleId),{ruleScanner:A,findOptions:N}=Sn(_,e,null,n,s===l),P=A.findNextMatchSync(t,s,N);if(!P)continue;const E=P.captureIndices[0].start;if(!(E>=f)&&(f=E,u=P.captureIndices,p=P.ruleId,h=k.priority,f===s))break}return u?{priorityMatch:h===-1,captureIndices:u,matchedRuleId:p}:null}function Sn(r,e,t,n,s){return{ruleScanner:r.compileAG(e,t,n,s),findOptions:0}}function lo(r,e,t,n,s){return{ruleScanner:r.compileWhileAG(e,t,n,s),findOptions:0}}function Be(r,e,t,n,s,i,l){if(i.length===0)return;const f=e.content,u=Math.min(i.length,l.length),p=[],h=l[0].end;for(let y=0;y<u;y++){const b=i[y];if(b===null)continue;const w=l[y];if(w.length===0)continue;if(w.start>h)break;for(;p.length>0&&p[p.length-1].endPos<=w.start;)s.produceFromScopes(p[p.length-1].scopes,p[p.length-1].endPos),p.pop();if(p.length>0?s.produceFromScopes(p[p.length-1].scopes,w.start):s.produce(n,w.start),b.retokenizeCapturedWithRuleId){const _=b.getName(f,l),A=n.contentNameScopesList.pushAttributed(_,r),N=b.getContentName(f,l),P=A.pushAttributed(N,r),E=n.push(b.retokenizeCapturedWithRuleId,w.start,-1,!1,null,A,P),T=r.createOnigString(f.substring(0,w.end));wn(r,T,t&&w.start===0,w.start,E,s,!1,0),on(T);continue}const k=b.getName(f,l);if(k!==null){const _=(p.length>0?p[p.length-1].scopes:n.contentNameScopesList).pushAttributed(k,r);p.push(new co(_,w.end))}}for(;p.length>0;)s.produceFromScopes(p[p.length-1].scopes,p[p.length-1].endPos),p.pop()}class co{constructor(e,t){g(this,"scopes");g(this,"endPos");this.scopes=e,this.endPos=t}}function uo(r,e,t,n,s,i,l,f){return new fo(r,e,t,n,s,i,l,f)}function kn(r,e,t,n,s){const i=He(e,Qe),l=W.getCompiledRuleId(t,n,s.repository);for(const f of i)r.push({debugSelector:e,matcher:f.matcher,ruleId:l,grammar:s,priority:f.priority})}function Qe(r,e){if(e.length<r.length)return!1;let t=0;return r.every(n=>{for(let s=t;s<e.length;s++)if(ho(e[s],n))return t=s+1,!0;return!1})}function ho(r,e){if(!r)return!1;if(r===e)return!0;const t=e.length;return r.length>t&&r.substr(0,t)===e&&r[t]==="."}class fo{constructor(e,t,n,s,i,l,f,u){g(this,"_rootScopeName");g(this,"balancedBracketSelectors");g(this,"_onigLib");g(this,"_rootId");g(this,"_lastRuleId");g(this,"_ruleId2desc");g(this,"_includedGrammars");g(this,"_grammarRepository");g(this,"_grammar");g(this,"_injections");g(this,"_basicScopeAttributesProvider");g(this,"_tokenTypeMatchers");if(this._rootScopeName=e,this.balancedBracketSelectors=l,this._onigLib=u,this._basicScopeAttributesProvider=new Ct(n,s),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=f,this._grammar=vn(t,null),this._injections=null,this._tokenTypeMatchers=[],i)for(const p of Object.keys(i)){const h=He(p,Qe);for(const y of h)this._tokenTypeMatchers.push({matcher:y.matcher,type:i[p]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const e of this._ruleId2desc)e&&e.dispose()}createOnigScanner(e){return this._onigLib.createOnigScanner(e)}createOnigString(e){return this._onigLib.createOnigString(e)}getMetadataForScope(e){return this._basicScopeAttributesProvider.getBasicScopeAttributes(e)}_collectInjections(){const e={lookup:i=>i===this._rootScopeName?this._grammar:this.getExternalGrammar(i),injections:i=>this._grammarRepository.injections(i)},t=[],n=this._rootScopeName,s=e.lookup(n);if(s){const i=s.injections;if(i)for(let f in i)kn(t,f,i[f],this,s);const l=this._grammarRepository.injections(n);l&&l.forEach(f=>{const u=this.getExternalGrammar(f);if(u){const p=u.injectionSelector;p&&kn(t,p,u,this,u)}})}return t.sort((i,l)=>i.priority-l.priority),t}getInjections(){return this._injections===null&&(this._injections=this._collectInjections()),this._injections}registerRule(e){const t=++this._lastRuleId,n=e(t);return this._ruleId2desc[t]=n,n}getRule(e){return this._ruleId2desc[e]}getExternalGrammar(e,t){if(this._includedGrammars[e])return this._includedGrammars[e];if(this._grammarRepository){const n=this._grammarRepository.lookup(e);if(n)return this._includedGrammars[e]=vn(n,t&&t.$base),this._includedGrammars[e]}}tokenizeLine(e,t,n=0){const s=this._tokenize(e,t,!1,n);return{tokens:s.lineTokens.getResult(s.ruleStack,s.lineLength),ruleStack:s.ruleStack,stoppedEarly:s.stoppedEarly}}tokenizeLine2(e,t,n=0){const s=this._tokenize(e,t,!0,n);return{tokens:s.lineTokens.getBinaryResult(s.ruleStack,s.lineLength),ruleStack:s.ruleStack,stoppedEarly:s.stoppedEarly}}_tokenize(e,t,n,s){this._rootId===-1&&(this._rootId=W.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections());let i;if(!t||t===xe.NULL){i=!0;const h=this._basicScopeAttributesProvider.getDefaultAttributes(),y=this.themeProvider.getDefaults(),b=Se.set(0,h.languageId,h.tokenType,null,y.fontStyle,y.foregroundId,y.backgroundId),w=this.getRule(this._rootId).getName(null,null);let k;w?k=V.createRootAndLookUpScopeName(w,b,this):k=V.createRoot("unknown",b),t=new xe(null,this._rootId,-1,-1,!1,null,k,k)}else i=!1,t.reset();e=e+`
`;const l=this.createOnigString(e),f=l.content.length,u=new go(n,e,this._tokenTypeMatchers,this.balancedBracketSelectors),p=wn(this,l,i,0,t,u,!0,s);return on(l),{lineLength:f,lineTokens:u,ruleStack:p.stack,stoppedEarly:p.stoppedEarly}}}function vn(r,e){return r=xr(r),r.repository=r.repository||{},r.repository.$self={$vscodeTextmateLocation:r.$vscodeTextmateLocation,patterns:r.patterns,name:r.scopeName},r.repository.$base=e||r.repository.$self,r}class V{constructor(e,t,n){g(this,"parent");g(this,"scopePath");g(this,"tokenAttributes");this.parent=e,this.scopePath=t,this.tokenAttributes=n}static fromExtension(e,t){let n=e,s=(e==null?void 0:e.scopePath)??null;for(const i of t)s=me.push(s,i.scopeNames),n=new V(n,s,i.encodedTokenAttributes);return n}static createRoot(e,t){return new V(null,new me(null,e),t)}static createRootAndLookUpScopeName(e,t,n){const s=n.getMetadataForScope(e),i=new me(null,e),l=n.themeProvider.themeMatch(i),f=V.mergeAttributes(t,s,l);return new V(null,i,f)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(e){return V.equals(this,e)}static equals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.scopeName!==t.scopeName||e.tokenAttributes!==t.tokenAttributes)return!1;e=e.parent,t=t.parent}while(!0)}static mergeAttributes(e,t,n){let s=-1,i=0,l=0;return n!==null&&(s=n.fontStyle,i=n.foregroundId,l=n.backgroundId),Se.set(e,t.languageId,t.tokenType,null,s,i,l)}pushAttributed(e,t){if(e===null)return this;if(e.indexOf(" ")===-1)return V._pushAttributed(this,e,t);const n=e.split(/ /g);let s=this;for(const i of n)s=V._pushAttributed(s,i,t);return s}static _pushAttributed(e,t,n){const s=n.getMetadataForScope(t),i=e.scopePath.push(t),l=n.themeProvider.themeMatch(i),f=V.mergeAttributes(e.tokenAttributes,s,l);return new V(e,i,f)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(e){var s;const t=[];let n=this;for(;n&&n!==e;)t.push({encodedTokenAttributes:n.tokenAttributes,scopeNames:n.scopePath.getExtensionIfDefined(((s=n.parent)==null?void 0:s.scopePath)??null)}),n=n.parent;return n===e?t.reverse():void 0}}const ce=class ce{constructor(e,t,n,s,i,l,f,u){g(this,"parent");g(this,"ruleId");g(this,"beginRuleCapturedEOL");g(this,"endRule");g(this,"nameScopesList");g(this,"contentNameScopesList");g(this,"_stackElementBrand");g(this,"_enterPos");g(this,"_anchorPos");g(this,"depth");this.parent=e,this.ruleId=t,this.beginRuleCapturedEOL=i,this.endRule=l,this.nameScopesList=f,this.contentNameScopesList=u,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=n,this._anchorPos=s}equals(e){return e===null?!1:ce._equals(this,e)}static _equals(e,t){return e===t?!0:this._structuralEquals(e,t)?V.equals(e.contentNameScopesList,t.contentNameScopesList):!1}static _structuralEquals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.depth!==t.depth||e.ruleId!==t.ruleId||e.endRule!==t.endRule)return!1;e=e.parent,t=t.parent}while(!0)}clone(){return this}static _reset(e){for(;e;)e._enterPos=-1,e._anchorPos=-1,e=e.parent}reset(){ce._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(e,t,n,s,i,l,f){return new ce(this,e,t,n,s,i,l,f)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(e){return e.getRule(this.ruleId)}toString(){const e=[];return this._writeString(e,0),"["+e.join(",")+"]"}_writeString(e,t){var n,s;return this.parent&&(t=this.parent._writeString(e,t)),e[t++]=`(${this.ruleId}, ${(n=this.nameScopesList)==null?void 0:n.toString()}, ${(s=this.contentNameScopesList)==null?void 0:s.toString()})`,t}withContentNameScopesList(e){return this.contentNameScopesList===e?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,e)}withEndRule(e){return this.endRule===e?this:new ce(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,e,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(e){let t=this;for(;t&&t._enterPos===e._enterPos;){if(t.ruleId===e.ruleId)return!0;t=t.parent}return!1}toStateStackFrame(){var e,t,n;return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:((t=this.nameScopesList)==null?void 0:t.getExtensionIfDefined(((e=this.parent)==null?void 0:e.nameScopesList)??null))??[],contentNameScopesList:((n=this.contentNameScopesList)==null?void 0:n.getExtensionIfDefined(this.nameScopesList))??[]}}static pushFrame(e,t){const n=V.fromExtension((e==null?void 0:e.nameScopesList)??null,t.nameScopesList);return new ce(e,t.ruleId,t.enterPos??-1,t.anchorPos??-1,t.beginRuleCapturedEOL,t.endRule,n,V.fromExtension(n,t.contentNameScopesList))}};g(ce,"NULL",new ce(null,0,0,0,!1,null,null,null));let xe=ce;class po{constructor(e,t){g(this,"balancedBracketScopes");g(this,"unbalancedBracketScopes");g(this,"allowAny",!1);this.balancedBracketScopes=e.flatMap(n=>n==="*"?(this.allowAny=!0,[]):He(n,Qe).map(s=>s.matcher)),this.unbalancedBracketScopes=t.flatMap(n=>He(n,Qe).map(s=>s.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(e){for(const t of this.unbalancedBracketScopes)if(t(e))return!1;for(const t of this.balancedBracketScopes)if(t(e))return!0;return this.allowAny}}class go{constructor(e,t,n,s){g(this,"balancedBracketSelectors");g(this,"_emitBinaryTokens");g(this,"_lineText");g(this,"_tokens");g(this,"_binaryTokens");g(this,"_lastTokenEndIndex");g(this,"_tokenTypeOverrides");this.balancedBracketSelectors=s,this._emitBinaryTokens=e,this._tokenTypeOverrides=n,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(e,t){this.produceFromScopes(e.contentNameScopesList,t)}produceFromScopes(e,t){var s;if(this._lastTokenEndIndex>=t)return;if(this._emitBinaryTokens){let i=(e==null?void 0:e.tokenAttributes)??0,l=!1;if((s=this.balancedBracketSelectors)!=null&&s.matchesAlways&&(l=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const f=(e==null?void 0:e.getScopeNames())??[];for(const u of this._tokenTypeOverrides)u.matcher(f)&&(i=Se.set(i,0,u.type,null,-1,0,0));this.balancedBracketSelectors&&(l=this.balancedBracketSelectors.match(f))}if(l&&(i=Se.set(i,0,8,l,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===i){this._lastTokenEndIndex=t;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(i),this._lastTokenEndIndex=t;return}const n=(e==null?void 0:e.getScopeNames())??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:t,scopes:n}),this._lastTokenEndIndex=t}getResult(e,t){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===t-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(e,t),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(e,t){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===t-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(e,t),this._binaryTokens[this._binaryTokens.length-2]=0);const n=new Uint32Array(this._binaryTokens.length);for(let s=0,i=this._binaryTokens.length;s<i;s++)n[s]=this._binaryTokens[s];return n}}class mo{constructor(e,t){g(this,"_onigLibPromise");g(this,"_grammars",new Map);g(this,"_rawGrammars",new Map);g(this,"_injectionGrammars",new Map);g(this,"_theme");this._onigLibPromise=t,this._theme=e}dispose(){for(const e of this._grammars.values())e.dispose()}setTheme(e){this._theme=e}getColorMap(){return this._theme.getColorMap()}addGrammar(e,t){this._rawGrammars.set(e.scopeName,e),t&&this._injectionGrammars.set(e.scopeName,t)}lookup(e){return this._rawGrammars.get(e)}injections(e){return this._injectionGrammars.get(e)}getDefaults(){return this._theme.getDefaults()}themeMatch(e){return this._theme.match(e)}async grammarForScopeName(e,t,n,s,i){if(!this._grammars.has(e)){let l=this._rawGrammars.get(e);if(!l)return null;this._grammars.set(e,uo(e,l,t,n,s,i,this,await this._onigLibPromise))}return this._grammars.get(e)}}let yo=class{constructor(r){g(this,"_options");g(this,"_syncRegistry");g(this,"_ensureGrammarCache");this._options=r,this._syncRegistry=new mo(Je.createFromRawTheme(r.theme,r.colorMap),r.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(r,e){this._syncRegistry.setTheme(Je.createFromRawTheme(r,e))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(r,e,t){return this.loadGrammarWithConfiguration(r,e,{embeddedLanguages:t})}loadGrammarWithConfiguration(r,e,t){return this._loadGrammar(r,e,t.embeddedLanguages,t.tokenTypes,new po(t.balancedBracketSelectors||[],t.unbalancedBracketSelectors||[]))}loadGrammar(r){return this._loadGrammar(r,0,null,null,null)}async _loadGrammar(r,e,t,n,s){const i=new Dr(this._syncRegistry,r);for(;i.Q.length>0;)await Promise.all(i.Q.map(l=>this._loadSingleGrammar(l.scopeName))),i.processQueue();return this._grammarForScopeName(r,e,t,n,s)}async _loadSingleGrammar(r){return this._ensureGrammarCache.has(r)||this._ensureGrammarCache.set(r,this._doLoadSingleGrammar(r)),this._ensureGrammarCache.get(r)}async _doLoadSingleGrammar(r){const e=await this._options.loadGrammar(r);if(e){const t=typeof this._options.getInjections=="function"?this._options.getInjections(r):void 0;this._syncRegistry.addGrammar(e,t)}}async addGrammar(r,e=[],t=0,n=null){return this._syncRegistry.addGrammar(r,e),await this._grammarForScopeName(r.scopeName,t,n)}_grammarForScopeName(r,e=0,t=null,n=null,s=null){return this._syncRegistry.grammarForScopeName(r,e,t,n,s)}};const Cn=xe.NULL,K={LANGUAGEID_MASK:255,TOKEN_TYPE_MASK:768,BALANCED_BRACKETS_MASK:1024,FONT_STYLE_MASK:14336,FOREGROUND_MASK:8372224,BACKGROUND_MASK:4286578688,LANGUAGEID_OFFSET:0,TOKEN_TYPE_OFFSET:8,BALANCED_BRACKETS_OFFSET:10,FONT_STYLE_OFFSET:11,FOREGROUND_OFFSET:15,BACKGROUND_OFFSET:24};class ie{static toBinaryStr(e){let t=e.toString(2);for(;t.length<32;)t=`0${t}`;return t}static getLanguageId(e){return(e&K.LANGUAGEID_MASK)>>>K.LANGUAGEID_OFFSET}static getTokenType(e){return(e&K.TOKEN_TYPE_MASK)>>>K.TOKEN_TYPE_OFFSET}static getFontStyle(e){return(e&K.FONT_STYLE_MASK)>>>K.FONT_STYLE_OFFSET}static getForeground(e){return(e&K.FOREGROUND_MASK)>>>K.FOREGROUND_OFFSET}static getBackground(e){return(e&K.BACKGROUND_MASK)>>>K.BACKGROUND_OFFSET}static containsBalancedBrackets(e){return(e&K.BALANCED_BRACKETS_MASK)!==0}static set(e,t,n,s,i,l){let f=ie.getLanguageId(e),u=ie.getTokenType(e),p=ie.getFontStyle(e),h=ie.getForeground(e),y=ie.getBackground(e);const b=ie.containsBalancedBrackets(e)?1:0;return t!==0&&(f=t),n!==0&&(u=n===8?0:n),s!==te.NotSet&&(p=s),i!==0&&(h=i),l!==0&&(y=l),(f<<K.LANGUAGEID_OFFSET|u<<K.TOKEN_TYPE_OFFSET|p<<K.FONT_STYLE_OFFSET|b<<K.BALANCED_BRACKETS_OFFSET|h<<K.FOREGROUND_OFFSET|y<<K.BACKGROUND_OFFSET)>>>0}}function Ze(r,e=!1){var i;const t=r.split(/(\r?\n)/g);let n=0;const s=[];for(let l=0;l<t.length;l+=2){const f=e?t[l]+(t[l+1]||""):t[l];s.push([f,n]),n+=t[l].length,n+=((i=t[l+1])==null?void 0:i.length)||0}return s}function At(r){return!r||["plaintext","txt","text","plain"].includes(r)}function bo(r){return r==="ansi"||At(r)}function Et(r){return r==="none"}function _o(r){return Et(r)}function An(r,e){var n;if(!e)return r;r.properties||(r.properties={}),(n=r.properties).class||(n.class=[]),typeof r.properties.class=="string"&&(r.properties.class=r.properties.class.split(/\s+/g)),Array.isArray(r.properties.class)||(r.properties.class=[]);const t=Array.isArray(e)?e:e.split(/\s+/g);for(const s of t)s&&!r.properties.class.includes(s)&&r.properties.class.push(s);return r}function wo(r,e){let t=0;const n=[];for(const s of e)s>t&&n.push({...r,content:r.content.slice(t,s),offset:r.offset+t}),t=s;return t<r.content.length&&n.push({...r,content:r.content.slice(t),offset:r.offset+t}),n}function So(r,e){const t=Array.from(e instanceof Set?e:new Set(e)).sort((n,s)=>n-s);return t.length?r.map(n=>n.flatMap(s=>{const i=t.filter(l=>s.offset<l&&l<s.offset+s.content.length).map(l=>l-s.offset).sort((l,f)=>l-f);return i.length?wo(s,i):s})):r}function et(r,e){const t=typeof r=="string"?{}:{...r.colorReplacements},n=typeof r=="string"?r:r.name;for(const[s,i]of Object.entries((e==null?void 0:e.colorReplacements)||{}))typeof i=="string"?t[s]=i:s===n&&Object.assign(t,i);return t}function fe(r,e){return r&&((e==null?void 0:e[r==null?void 0:r.toLowerCase()])||r)}function En(r){const e={};return r.color&&(e.color=r.color),r.bgColor&&(e["background-color"]=r.bgColor),r.fontStyle&&(r.fontStyle&te.Italic&&(e["font-style"]="italic"),r.fontStyle&te.Bold&&(e["font-weight"]="bold"),r.fontStyle&te.Underline&&(e["text-decoration"]="underline")),e}function Tn(r){return Object.entries(r).map(([e,t])=>`${e}:${t}`).join(";")}function ko(r){const e=Ze(r,!0).map(([s])=>s);function t(s){let i=s,l=0;for(const f of e){if(i<f.length)break;i-=f.length,l++}return{line:l,character:i}}function n(s,i){let l=0;for(let f=0;f<s;f++)l+=e[f].length;return l+=i,l}return{lines:e,indexToPos:t,posToIndex:n}}var pe=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],Tt={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function vo(r,e){const t=r.indexOf("\x1B[",e);if(t!==-1){const n=r.indexOf("m",t);return{sequence:r.substring(t+2,n).split(";"),startPosition:t,position:n+1}}return{position:r.length}}function Nn(r,e){let t=1;const n=r[e+t++];let s;if(n==="2"){const i=[r[e+t++],r[e+t++],r[e+t]].map(l=>Number.parseInt(l));i.length===3&&!i.some(l=>Number.isNaN(l))&&(s={type:"rgb",rgb:i})}else if(n==="5"){const i=Number.parseInt(r[e+t]);Number.isNaN(i)||(s={type:"table",index:Number(i)})}return[t,s]}function Co(r){const e=[];for(let t=0;t<r.length;t++){const n=r[t],s=Number.parseInt(n);if(!Number.isNaN(s))if(s===0)e.push({type:"resetAll"});else if(s<=9)Tt[s]&&e.push({type:"setDecoration",value:Tt[s]});else if(s<=29){const i=Tt[s-20];i&&e.push({type:"resetDecoration",value:i})}else if(s<=37)e.push({type:"setForegroundColor",value:{type:"named",name:pe[s-30]}});else if(s===38){const[i,l]=Nn(r,t);l&&e.push({type:"setForegroundColor",value:l}),t+=i}else if(s===39)e.push({type:"resetForegroundColor"});else if(s<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:pe[s-40]}});else if(s===48){const[i,l]=Nn(r,t);l&&e.push({type:"setBackgroundColor",value:l}),t+=i}else s===49?e.push({type:"resetBackgroundColor"}):s>=90&&s<=97?e.push({type:"setForegroundColor",value:{type:"named",name:pe[s-90+8]}}):s>=100&&s<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:pe[s-100+8]}})}return e}function Ao(){let r=null,e=null,t=new Set;return{parse(n){const s=[];let i=0;do{const l=vo(n,i),f=l.sequence?n.substring(i,l.startPosition):n.substring(i);if(f.length>0&&s.push({value:f,foreground:r,background:e,decorations:new Set(t)}),l.sequence){const u=Co(l.sequence);for(const p of u)p.type==="resetAll"?(r=null,e=null,t.clear()):p.type==="resetForegroundColor"?r=null:p.type==="resetBackgroundColor"?e=null:p.type==="resetDecoration"&&t.delete(p.value);for(const p of u)p.type==="setForegroundColor"?r=p.value:p.type==="setBackgroundColor"?e=p.value:p.type==="setDecoration"&&t.add(p.value)}i=l.position}while(i<n.length);return s}}}var Eo={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function To(r=Eo){function e(f){return r[f]}function t(f){return`#${f.map(u=>Math.max(0,Math.min(u,255)).toString(16).padStart(2,"0")).join("")}`}let n;function s(){if(n)return n;n=[];for(let p=0;p<pe.length;p++)n.push(e(pe[p]));let f=[0,95,135,175,215,255];for(let p=0;p<6;p++)for(let h=0;h<6;h++)for(let y=0;y<6;y++)n.push(t([f[p],f[h],f[y]]));let u=8;for(let p=0;p<24;p++,u+=10)n.push(t([u,u,u]));return n}function i(f){return s()[f]}function l(f){switch(f.type){case"named":return e(f.name);case"rgb":return t(f.rgb);case"table":return i(f.index)}}return{value:l}}function No(r,e,t){const n=et(r,t),s=Ze(e),i=To(Object.fromEntries(pe.map(f=>{var u;return[f,(u=r.colors)==null?void 0:u[`terminal.ansi${f[0].toUpperCase()}${f.substring(1)}`]]}))),l=Ao();return s.map(f=>l.parse(f[0]).map(u=>{let p,h;u.decorations.has("reverse")?(p=u.background?i.value(u.background):r.bg,h=u.foreground?i.value(u.foreground):r.fg):(p=u.foreground?i.value(u.foreground):r.fg,h=u.background?i.value(u.background):void 0),p=fe(p,n),h=fe(h,n),u.decorations.has("dim")&&(p=Lo(p));let y=te.None;return u.decorations.has("bold")&&(y|=te.Bold),u.decorations.has("italic")&&(y|=te.Italic),u.decorations.has("underline")&&(y|=te.Underline),{content:u.value,offset:f[1],color:p,bgColor:h,fontStyle:y}}))}function Lo(r){const e=r.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const n=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${n}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(n=>`${n}${n}`).join("")}80`;const t=r.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return t?`var(${t[1]}-dim)`:r}class G extends Error{constructor(e){super(e),this.name="ShikiError"}}class Ln{constructor(e,t,n){g(this,"_stack");g(this,"lang");g(this,"theme");this._stack=e,this.lang=t,this.theme=n}get scopes(){return Po(this._stack)}toJSON(){return{lang:this.lang,theme:this.theme,scopes:this.scopes}}}function Po(r){const e=[],t=new Set;function n(s){var l;if(t.has(s))return;t.add(s);const i=(l=s==null?void 0:s.nameScopesList)==null?void 0:l.scopeName;i&&e.push(i),s.parent&&n(s.parent)}return n(r),e}function Ro(r){if(!(r instanceof Ln))throw new G("Invalid grammar state");return r._stack}function Nt(r,e,t={}){const{lang:n="text",theme:s=r.getLoadedThemes()[0]}=t;if(At(n)||Et(s))return Ze(e).map(u=>[{content:u[0],offset:u[1]}]);const{theme:i,colorMap:l}=r.setTheme(s);if(n==="ansi")return No(i,e,t);const f=r.getLanguage(n);if(t.grammarState){if(t.grammarState.lang!==f.name)throw new G(`Grammar state language "${t.grammarState.lang}" does not match highlight language "${f.name}"`);if(t.grammarState.theme!==s)throw new G(`Grammar state theme "${t.grammarState.theme}" does not match highlight theme "${s}"`)}return Oo(e,f,i,l,t)}function Io(r,e,t={}){const{lang:n="text",theme:s=r.getLoadedThemes()[0]}=t;if(At(n)||Et(s))throw new G("Plain language does not have grammar state");if(n==="ansi")throw new G("ANSI language does not have grammar state");const{theme:i,colorMap:l}=r.setTheme(s),f=r.getLanguage(n);return new Ln(Lt(e,f,i,l,t).stateStack,f.name,i.name)}function Oo(r,e,t,n,s){return Lt(r,e,t,n,s).tokens}function Lt(r,e,t,n,s){const i=et(t,s),{tokenizeMaxLineLength:l=0,tokenizeTimeLimit:f=500}=s,u=Ze(r);let p=s.grammarState?Ro(s.grammarState):s.grammarContextCode!=null?Lt(s.grammarContextCode,e,t,n,{...s,grammarState:void 0,grammarContextCode:void 0}).stateStack:Cn,h=[];const y=[],b=[];if(s.includeExplanation)for(const w of t.settings){let k;switch(typeof w.scope){case"string":k=w.scope.split(/,/).map(_=>_.trim());break;case"object":k=w.scope;break;default:continue}b.push({settings:w,selectors:k.map(_=>_.split(/ /))})}for(let w=0,k=u.length;w<k;w++){const[_,A]=u[w];if(_===""){h=[],y.push([]);continue}if(l>0&&_.length>=l){h=[],y.push([{content:_,offset:A,color:"",fontStyle:0}]);continue}let N,P,E;s.includeExplanation&&(N=e.tokenizeLine(_,p),P=N.tokens,E=0);const T=e.tokenizeLine2(_,p,f),L=T.tokens.length/2;for(let R=0;R<L;R++){const Y=T.tokens[2*R],j=R+1<L?T.tokens[2*R+2]:_.length;if(Y===j)continue;const Ee=T.tokens[2*R+1],De=fe(n[ie.getForeground(Ee)],i),ht=ie.getFontStyle(Ee),Te={content:_.substring(Y,j),offset:A+Y,color:De,fontStyle:ht};if(s.includeExplanation){Te.explanation=[];let $e=0;for(;Y+$e<j;){const Ne=P[E],je=_.substring(Ne.startIndex,Ne.endIndex);$e+=je.length,Te.explanation.push({content:je,scopes:Bo(b,Ne.scopes)}),E+=1}}h.push(Te)}y.push(h),h=[],p=T.ruleStack}return{tokens:y,stateStack:p}}function Bo(r,e){const t=[];for(let n=0,s=e.length;n<s;n++){const i=e.slice(0,n),l=e[n];t[n]={scopeName:l,themeMatches:Mo(r,l,i)}}return t}function Pn(r,e){return r===e||e.substring(0,r.length)===r&&e[r.length]==="."}function xo(r,e,t){if(!Pn(r[r.length-1],e))return!1;let n=r.length-2,s=t.length-1;for(;n>=0&&s>=0;)Pn(r[n],t[s])&&(n-=1),s-=1;return n===-1}function Mo(r,e,t){const n=[];for(const{selectors:s,settings:i}of r)for(const l of s)if(xo(l,e,t)){n.push(i);break}return n}function Rn(r,e,t){const n=Object.entries(t.themes).filter(i=>i[1]).map(i=>({color:i[0],theme:i[1]})),s=Uo(...n.map(i=>Nt(r,e,{...t,theme:i.theme})));return s[0].map((i,l)=>i.map((f,u)=>{const p={content:f.content,variants:{},offset:f.offset};return s.forEach((h,y)=>{const{content:b,explanation:w,offset:k,..._}=h[l][u];p.variants[n[y].color]=_}),p}))}function Uo(...r){const e=r.map(()=>[]),t=r.length;for(let n=0;n<r[0].length;n++){const s=r.map(u=>u[n]),i=e.map(()=>[]);e.forEach((u,p)=>u.push(i[p]));const l=s.map(()=>0),f=s.map(u=>u[0]);for(;f.every(u=>u);){const u=Math.min(...f.map(p=>p.content.length));for(let p=0;p<t;p++){const h=f[p];h.content.length===u?(i[p].push(h),l[p]+=1,f[p]=s[p][l[p]]):(i[p].push({...h,content:h.content.slice(0,u)}),f[p]={...h,content:h.content.slice(u),offset:h.offset+u})}}}return e}function tt(r,e,t){let n,s,i,l,f;if("themes"in t){const{defaultColor:u="light",cssVariablePrefix:p="--shiki-"}=t,h=Object.entries(t.themes).filter(_=>_[1]).map(_=>({color:_[0],theme:_[1]})).sort((_,A)=>_.color===u?-1:A.color===u?1:0);if(h.length===0)throw new G("`themes` option must not be empty");const y=Rn(r,e,t);if(u&&!h.find(_=>_.color===u))throw new G(`\`themes\` option must contain the defaultColor key \`${u}\``);const b=h.map(_=>r.getTheme(_.theme)),w=h.map(_=>_.color);i=y.map(_=>_.map(A=>Go(A,w,p,u)));const k=h.map(_=>et(_.theme,t));s=h.map((_,A)=>(A===0&&u?"":`${p+_.color}:`)+(fe(b[A].fg,k[A])||"inherit")).join(";"),n=h.map((_,A)=>(A===0&&u?"":`${p+_.color}-bg:`)+(fe(b[A].bg,k[A])||"inherit")).join(";"),l=`shiki-themes ${b.map(_=>_.name).join(" ")}`,f=u?void 0:[s,n].join(";")}else if("theme"in t){const u=et(t.theme,t.colorReplacements);i=Nt(r,e,t);const p=r.getTheme(t.theme);n=fe(p.bg,u),s=fe(p.fg,u),l=p.name}else throw new G("Invalid options, either `theme` or `themes` must be provided");return{tokens:i,fg:s,bg:n,themeName:l,rootStyle:f}}function Go(r,e,t,n){const s={content:r.content,explanation:r.explanation,offset:r.offset},i=e.map(u=>En(r.variants[u])),l=new Set(i.flatMap(u=>Object.keys(u))),f=i.reduce((u,p,h)=>{for(const y of l){const b=p[y]||"inherit";if(h===0&&n)u[y]=b;else{const w=y==="color"?"":y==="background-color"?"-bg":`-${y}`,k=t+e[h]+(y==="color"?"":w);u[y]?u[y]+=`;${k}:${b}`:u[y]=`${k}:${b}`}}return u},{});return s.htmlStyle=n?Tn(f):Object.values(f).join(";"),s}function Fo(){const r=new WeakMap;function e(n){if(!r.has(n.meta)){let s=function(f){return typeof f=="number"?{...i.indexToPos(f),offset:f}:{...f,offset:i.posToIndex(f.line,f.character)}};const i=ko(n.source),l=(n.options.decorations||[]).map(f=>({...f,start:s(f.start),end:s(f.end)}));t(l),r.set(n.meta,{decorations:l,converter:i,source:n.source})}return r.get(n.meta)}function t(n){for(let s=0;s<n.length;s++){const i=n[s];if(i.start.offset>i.end.offset)throw new G(`Invalid decoration range: ${JSON.stringify(i.start)} - ${JSON.stringify(i.end)}`);for(let l=s+1;l<n.length;l++){const f=n[l],u=i.start.offset<f.start.offset&&f.start.offset<i.end.offset,p=i.start.offset<f.end.offset&&f.end.offset<i.end.offset,h=f.start.offset<i.start.offset&&i.start.offset<f.end.offset,y=f.start.offset<i.end.offset&&i.end.offset<f.end.offset;if(u||p||h||y){if(p&&p||h&&y)continue;throw new G(`Decorations ${JSON.stringify(i.start)} and ${JSON.stringify(f.start)} intersect.`)}}}}return{name:"shiki:decorations",tokens(n){var i;if(!((i=this.options.decorations)!=null&&i.length))return;const s=e(this).decorations.flatMap(l=>[l.start.offset,l.end.offset]);return So(n,s)},code(n){var y;if(!((y=this.options.decorations)!=null&&y.length))return;const s=e(this),i=Array.from(n.children).filter(b=>b.type==="element"&&b.tagName==="span");if(i.length!==s.converter.lines.length)throw new G(`Number of lines in code element (${i.length}) does not match the number of lines in the source (${s.converter.lines.length}). Failed to apply decorations.`);function l(b,w,k,_){const A=i[b];let N="",P=-1,E=-1;function T(R){return R.type==="text"?R.value:R.type==="element"?R.children.map(T).join(""):""}if(w===0&&(P=0),k===0&&(E=0),k===Number.POSITIVE_INFINITY&&(E=A.children.length),P===-1||E===-1)for(let R=0;R<A.children.length;R++)N+=T(A.children[R]),P===-1&&N.length===w&&(P=R+1),E===-1&&N.length===k&&(E=R+1);if(P===-1)throw new G(`Failed to find start index for decoration ${JSON.stringify(_.start)}`);if(E===-1)throw new G(`Failed to find end index for decoration ${JSON.stringify(_.end)}`);const L=A.children.slice(P,E);if(!_.alwaysWrap&&L.length===A.children.length)u(A,_,"line");else if(!_.alwaysWrap&&L.length===1&&L[0].type==="element")u(L[0],_,"token");else{const R={type:"element",tagName:"span",properties:{},children:L};u(R,_,"wrapper"),A.children.splice(P,L.length,R)}}function f(b,w){i[b]=u(i[b],w,"line")}function u(b,w,k){var N;const _=w.properties||{},A=w.transform||(P=>P);return b.tagName=w.tagName||"span",b.properties={...b.properties,..._,class:b.properties.class},(N=w.properties)!=null&&N.class&&An(b,w.properties.class),b=A(b,k)||b,b}const p=[],h=s.decorations.sort((b,w)=>w.start.offset-b.start.offset);for(const b of h){const{start:w,end:k}=b;if(w.line===k.line)l(w.line,w.character,k.character,b);else if(w.line<k.line){l(w.line,w.character,Number.POSITIVE_INFINITY,b);for(let _=w.line+1;_<k.line;_++)p.unshift(()=>f(_,b));l(k.line,0,k.character,b)}}p.forEach(b=>b())}}}const Do=[Fo()];function nt(r){return[...r.transformers||[],...Do]}function rt(r,e,t,n={meta:{},options:t,codeToHast:(s,i)=>rt(r,s,i),codeToTokens:(s,i)=>tt(r,s,i)}){var b,w;let s=e;for(const k of nt(t))s=((b=k.preprocess)==null?void 0:b.call(n,s,t))||s;let{tokens:i,fg:l,bg:f,themeName:u,rootStyle:p}=tt(r,s,t);const{mergeWhitespaces:h=!0}=t;h===!0?i=jo(i):h==="never"&&(i=zo(i));const y={...n,get source(){return s}};for(const k of nt(t))i=((w=k.tokens)==null?void 0:w.call(y,i))||i;return $o(i,{...t,fg:l,bg:f,themeName:u,rootStyle:p},y)}function $o(r,e,t){var b,w,k;const n=nt(e),s=[],i={type:"root",children:[]},{structure:l="classic"}=e;let f={type:"element",tagName:"pre",properties:{class:`shiki ${e.themeName||""}`,style:e.rootStyle||`background-color:${e.bg};color:${e.fg}`,tabindex:"0",...Object.fromEntries(Array.from(Object.entries(e.meta||{})).filter(([_])=>!_.startsWith("_")))},children:[]},u={type:"element",tagName:"code",properties:{},children:s};const p=[],h={...t,structure:l,addClassToHast:An,get source(){return t.source},get tokens(){return r},get options(){return e},get root(){return i},get pre(){return f},get code(){return u},get lines(){return p}};if(r.forEach((_,A)=>{var E,T;A&&(l==="inline"?i.children.push({type:"element",tagName:"br",properties:{},children:[]}):l==="classic"&&s.push({type:"text",value:`
`}));let N={type:"element",tagName:"span",properties:{class:"line"},children:[]},P=0;for(const L of _){let R={type:"element",tagName:"span",properties:{},children:[{type:"text",value:L.content}]};const Y=L.htmlStyle||Tn(En(L));Y&&(R.properties.style=Y);for(const j of n)R=((E=j==null?void 0:j.span)==null?void 0:E.call(h,R,A+1,P,N))||R;l==="inline"?i.children.push(R):l==="classic"&&N.children.push(R),P+=L.content.length}if(l==="classic"){for(const L of n)N=((T=L==null?void 0:L.line)==null?void 0:T.call(h,N,A+1))||N;p.push(N),s.push(N)}}),l==="classic"){for(const _ of n)u=((b=_==null?void 0:_.code)==null?void 0:b.call(h,u))||u;f.children.push(u);for(const _ of n)f=((w=_==null?void 0:_.pre)==null?void 0:w.call(h,f))||f;i.children.push(f)}let y=i;for(const _ of n)y=((k=_==null?void 0:_.root)==null?void 0:k.call(h,y))||y;return y}function jo(r){return r.map(e=>{const t=[];let n="",s=0;return e.forEach((i,l)=>{const f=!(i.fontStyle&&i.fontStyle&te.Underline);f&&i.content.match(/^\s+$/)&&e[l+1]?(s||(s=i.offset),n+=i.content):n?(f?t.push({...i,offset:s,content:n+i.content}):t.push({content:n,offset:s},i),s=0,n=""):t.push(i)}),t})}function zo(r){return r.map(e=>e.flatMap(t=>{if(t.content.match(/^\s+$/))return t;const n=t.content.match(/^(\s*)(.*?)(\s*)$/);if(!n)return t;const[,s,i,l]=n;if(!s&&!l)return t;const f=[{...t,offset:t.offset+s.length,content:i}];return s&&f.unshift({content:s,offset:t.offset}),l&&f.push({content:l,offset:t.offset+s.length+i.length}),f}))}const qo=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class Me{constructor(e,t,n){this.property=e,this.normal=t,n&&(this.space=n)}}Me.prototype.property={},Me.prototype.normal={},Me.prototype.space=null;function In(r,e){const t={},n={};let s=-1;for(;++s<r.length;)Object.assign(t,r[s].property),Object.assign(n,r[s].normal);return new Me(t,n,e)}function Pt(r){return r.toLowerCase()}class ee{constructor(e,t){this.property=e,this.attribute=t}}ee.prototype.space=null,ee.prototype.boolean=!1,ee.prototype.booleanish=!1,ee.prototype.overloadedBoolean=!1,ee.prototype.number=!1,ee.prototype.commaSeparated=!1,ee.prototype.spaceSeparated=!1,ee.prototype.commaOrSpaceSeparated=!1,ee.prototype.mustUseProperty=!1,ee.prototype.defined=!1;let Wo=0;const I=de(),D=de(),On=de(),v=de(),B=de(),ke=de(),Q=de();function de(){return 2**++Wo}var Rt=Object.freeze({__proto__:null,boolean:I,booleanish:D,commaOrSpaceSeparated:Q,commaSeparated:ke,number:v,overloadedBoolean:On,spaceSeparated:B});const It=Object.keys(Rt);class Ot extends ee{constructor(e,t,n,s){let i=-1;if(super(e,t),Bn(this,"space",s),typeof n=="number")for(;++i<It.length;){const l=It[i];Bn(this,It[i],(n&Rt[l])===Rt[l])}}}Ot.prototype.defined=!0;function Bn(r,e,t){t&&(r[e]=t)}const Ho={}.hasOwnProperty;function ve(r){const e={},t={};let n;for(n in r.properties)if(Ho.call(r.properties,n)){const s=r.properties[n],i=new Ot(n,r.transform(r.attributes||{},n),s,r.space);r.mustUseProperty&&r.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),e[n]=i,t[Pt(n)]=n,t[Pt(i.attribute)]=n}return new Me(e,t,r.space)}const xn=ve({space:"xlink",transform(r,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),Mn=ve({space:"xml",transform(r,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function Un(r,e){return e in r?r[e]:e}function Gn(r,e){return Un(r,e.toLowerCase())}const Fn=ve({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:Gn,properties:{xmlns:null,xmlnsXLink:null}}),Dn=ve({transform(r,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:D,ariaAutoComplete:null,ariaBusy:D,ariaChecked:D,ariaColCount:v,ariaColIndex:v,ariaColSpan:v,ariaControls:B,ariaCurrent:null,ariaDescribedBy:B,ariaDetails:null,ariaDisabled:D,ariaDropEffect:B,ariaErrorMessage:null,ariaExpanded:D,ariaFlowTo:B,ariaGrabbed:D,ariaHasPopup:null,ariaHidden:D,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:B,ariaLevel:v,ariaLive:null,ariaModal:D,ariaMultiLine:D,ariaMultiSelectable:D,ariaOrientation:null,ariaOwns:B,ariaPlaceholder:null,ariaPosInSet:v,ariaPressed:D,ariaReadOnly:D,ariaRelevant:null,ariaRequired:D,ariaRoleDescription:B,ariaRowCount:v,ariaRowIndex:v,ariaRowSpan:v,ariaSelected:D,ariaSetSize:v,ariaSort:null,ariaValueMax:v,ariaValueMin:v,ariaValueNow:v,ariaValueText:null,role:null}}),Ko=ve({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:Gn,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ke,acceptCharset:B,accessKey:B,action:null,allow:null,allowFullScreen:I,allowPaymentRequest:I,allowUserMedia:I,alt:null,as:null,async:I,autoCapitalize:null,autoComplete:B,autoFocus:I,autoPlay:I,blocking:B,capture:null,charSet:null,checked:I,cite:null,className:B,cols:v,colSpan:null,content:null,contentEditable:D,controls:I,controlsList:B,coords:v|ke,crossOrigin:null,data:null,dateTime:null,decoding:null,default:I,defer:I,dir:null,dirName:null,disabled:I,download:On,draggable:D,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:I,formTarget:null,headers:B,height:v,hidden:I,high:v,href:null,hrefLang:null,htmlFor:B,httpEquiv:B,id:null,imageSizes:null,imageSrcSet:null,inert:I,inputMode:null,integrity:null,is:null,isMap:I,itemId:null,itemProp:B,itemRef:B,itemScope:I,itemType:B,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:I,low:v,manifest:null,max:null,maxLength:v,media:null,method:null,min:null,minLength:v,multiple:I,muted:I,name:null,nonce:null,noModule:I,noValidate:I,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:I,optimum:v,pattern:null,ping:B,placeholder:null,playsInline:I,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:I,referrerPolicy:null,rel:B,required:I,reversed:I,rows:v,rowSpan:v,sandbox:B,scope:null,scoped:I,seamless:I,selected:I,shadowRootDelegatesFocus:I,shadowRootMode:null,shape:null,size:v,sizes:null,slot:null,span:v,spellCheck:D,src:null,srcDoc:null,srcLang:null,srcSet:null,start:v,step:null,style:null,tabIndex:v,target:null,title:null,translate:null,type:null,typeMustMatch:I,useMap:null,value:D,width:v,wrap:null,align:null,aLink:null,archive:B,axis:null,background:null,bgColor:null,border:v,borderColor:null,bottomMargin:v,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:I,declare:I,event:null,face:null,frame:null,frameBorder:null,hSpace:v,leftMargin:v,link:null,longDesc:null,lowSrc:null,marginHeight:v,marginWidth:v,noResize:I,noHref:I,noShade:I,noWrap:I,object:null,profile:null,prompt:null,rev:null,rightMargin:v,rules:null,scheme:null,scrolling:D,standby:null,summary:null,text:null,topMargin:v,valueType:null,version:null,vAlign:null,vLink:null,vSpace:v,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:I,disableRemotePlayback:I,prefix:null,property:null,results:v,security:null,unselectable:null}}),Yo=ve({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:Un,properties:{about:Q,accentHeight:v,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:v,amplitude:v,arabicForm:null,ascent:v,attributeName:null,attributeType:null,azimuth:v,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:v,by:null,calcMode:null,capHeight:v,className:B,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:v,diffuseConstant:v,direction:null,display:null,dur:null,divisor:v,dominantBaseline:null,download:I,dx:null,dy:null,edgeMode:null,editable:null,elevation:v,enableBackground:null,end:null,event:null,exponent:v,externalResourcesRequired:null,fill:null,fillOpacity:v,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ke,g2:ke,glyphName:ke,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:v,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:v,horizOriginX:v,horizOriginY:v,id:null,ideographic:v,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:v,k:v,k1:v,k2:v,k3:v,k4:v,kernelMatrix:Q,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:v,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:v,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:v,overlineThickness:v,paintOrder:null,panose1:null,path:null,pathLength:v,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:B,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:v,pointsAtY:v,pointsAtZ:v,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Q,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Q,rev:Q,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Q,requiredFeatures:Q,requiredFonts:Q,requiredFormats:Q,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:v,specularExponent:v,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:v,strikethroughThickness:v,string:null,stroke:null,strokeDashArray:Q,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:v,strokeOpacity:v,strokeWidth:null,style:null,surfaceScale:v,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Q,tabIndex:v,tableValues:null,target:null,targetX:v,targetY:v,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Q,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:v,underlineThickness:v,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:v,values:null,vAlphabetic:v,vMathematical:v,vectorEffect:null,vHanging:v,vIdeographic:v,version:null,vertAdvY:v,vertOriginX:v,vertOriginY:v,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:v,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),Vo=/^data[-\w.:]+$/i,$n=/-[a-z]/g,Xo=/[A-Z]/g;function Jo(r,e){const t=Pt(e);let n=e,s=ee;if(t in r.normal)return r.property[r.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&Vo.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace($n,Zo);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!$n.test(i)){let l=i.replace(Xo,Qo);l.charAt(0)!=="-"&&(l="-"+l),e="data"+l}}s=Ot}return new s(n,e)}function Qo(r){return"-"+r.toLowerCase()}function Zo(r){return r.charAt(1).toUpperCase()}const es=In([Mn,xn,Fn,Dn,Ko],"html"),jn=In([Mn,xn,Fn,Dn,Yo],"svg"),zn={}.hasOwnProperty;function ts(r,e){const t=e||{};function n(s,...i){let l=n.invalid;const f=n.handlers;if(s&&zn.call(s,r)){const u=String(s[r]);l=zn.call(f,u)?f[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=t.handlers||{},n.invalid=t.invalid,n.unknown=t.unknown,n}function ns(r,e){if(r=r.replace(e.subset?rs(e.subset):/["&'<>`]/g,n),e.subset||e.escapeOnly)return r;return r.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t).replace(/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,n);function t(s,i,l){return e.format((s.charCodeAt(0)-55296)*1024+s.charCodeAt(1)-56320+65536,l.charCodeAt(i+2),e)}function n(s,i,l){return e.format(s.charCodeAt(0),l.charCodeAt(i+1),e)}}function rs(r){const e=[];let t=-1;for(;++t<r.length;)e.push(r[t].replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}function os(r,e,t){const n="&#x"+r.toString(16).toUpperCase();return t&&e&&!/[\dA-Fa-f]/.test(String.fromCharCode(e))?n:n+";"}function ss(r,e,t){const n="&#"+String(r);return t&&e&&!/\d/.test(String.fromCharCode(e))?n:n+";"}const is=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Bt={nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",times:"\xD7",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",divide:"\xF7",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",fnof:"\u0192",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",bull:"\u2022",hellip:"\u2026",prime:"\u2032",Prime:"\u2033",oline:"\u203E",frasl:"\u2044",weierp:"\u2118",image:"\u2111",real:"\u211C",trade:"\u2122",alefsym:"\u2135",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lArr:"\u21D0",uArr:"\u21D1",rArr:"\u21D2",dArr:"\u21D3",hArr:"\u21D4",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",lang:"\u2329",rang:"\u232A",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666",quot:'"',amp:"&",lt:"<",gt:">",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",permil:"\u2030",lsaquo:"\u2039",rsaquo:"\u203A",euro:"\u20AC"},as=["cent","copy","divide","gt","lt","not","para","times"],qn={}.hasOwnProperty,xt={};let ot;for(ot in Bt)qn.call(Bt,ot)&&(xt[Bt[ot]]=ot);function ls(r,e,t,n){const s=String.fromCharCode(r);if(qn.call(xt,s)){const i=xt[s],l="&"+i;return t&&is.includes(i)&&!as.includes(i)&&(!n||e&&e!==61&&/[^\da-z]/i.test(String.fromCharCode(e)))?l:l+";"}return""}function cs(r,e,t){let n=os(r,e,t.omitOptionalSemicolons),s;if((t.useNamedReferences||t.useShortestReferences)&&(s=ls(r,e,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!s)&&t.useShortestReferences){const i=ss(r,e,t.omitOptionalSemicolons);i.length<n.length&&(n=i)}return s&&(!t.useShortestReferences||s.length<n.length)?s:n}function Ce(r,e){return ns(r,Object.assign({format:cs},e))}const us=/^>|^->|<!--|-->|--!>|<!-$/g,hs=[">"],fs=["<",">"];function ps(r,e,t,n){return n.settings.bogusComments?"<?"+Ce(r.value,Object.assign({},n.settings.characterReferences,{subset:hs}))+">":"<!--"+r.value.replace(us,s)+"-->";function s(i){return Ce(i,Object.assign({},n.settings.characterReferences,{subset:fs}))}}function ds(r,e,t,n){return"<!"+(n.settings.upperDoctype?"DOCTYPE":"doctype")+(n.settings.tightDoctype?"":" ")+"html>"}function Wn(r,e){const t=String(r);if(typeof e!="string")throw new TypeError("Expected character");let n=0,s=t.indexOf(e);for(;s!==-1;)n++,s=t.indexOf(e,s+e.length);return n}function gs(r,e){const t=e||{};return(r[r.length-1]===""?[...r,""]:r).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function ms(r){return r.join(" ").trim()}const ys=/[ \t\n\f\r]/g;function Mt(r){return typeof r=="object"?r.type==="text"?Hn(r.value):!1:Hn(r)}function Hn(r){return r.replace(ys,"")===""}const $=Yn(1),Kn=Yn(-1),bs=[];function Yn(r){return e;function e(t,n,s){const i=t?t.children:bs;let l=(n||0)+r,f=i[l];if(!s)for(;f&&Mt(f);)l+=r,f=i[l];return f}}const _s={}.hasOwnProperty;function Vn(r){return e;function e(t,n,s){return _s.call(r,t.tagName)&&r[t.tagName](t,n,s)}}const Ut=Vn({body:Ss,caption:Gt,colgroup:Gt,dd:As,dt:Cs,head:Gt,html:ws,li:vs,optgroup:Es,option:Ts,p:ks,rp:Xn,rt:Xn,tbody:Ls,td:Jn,tfoot:Ps,th:Jn,thead:Ns,tr:Rs});function Gt(r,e,t){const n=$(t,e,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Mt(n.value.charAt(0)))}function ws(r,e,t){const n=$(t,e);return!n||n.type!=="comment"}function Ss(r,e,t){const n=$(t,e);return!n||n.type!=="comment"}function ks(r,e,t){const n=$(t,e);return n?n.type==="element"&&(n.tagName==="address"||n.tagName==="article"||n.tagName==="aside"||n.tagName==="blockquote"||n.tagName==="details"||n.tagName==="div"||n.tagName==="dl"||n.tagName==="fieldset"||n.tagName==="figcaption"||n.tagName==="figure"||n.tagName==="footer"||n.tagName==="form"||n.tagName==="h1"||n.tagName==="h2"||n.tagName==="h3"||n.tagName==="h4"||n.tagName==="h5"||n.tagName==="h6"||n.tagName==="header"||n.tagName==="hgroup"||n.tagName==="hr"||n.tagName==="main"||n.tagName==="menu"||n.tagName==="nav"||n.tagName==="ol"||n.tagName==="p"||n.tagName==="pre"||n.tagName==="section"||n.tagName==="table"||n.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function vs(r,e,t){const n=$(t,e);return!n||n.type==="element"&&n.tagName==="li"}function Cs(r,e,t){const n=$(t,e);return!!(n&&n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd"))}function As(r,e,t){const n=$(t,e);return!n||n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd")}function Xn(r,e,t){const n=$(t,e);return!n||n.type==="element"&&(n.tagName==="rp"||n.tagName==="rt")}function Es(r,e,t){const n=$(t,e);return!n||n.type==="element"&&n.tagName==="optgroup"}function Ts(r,e,t){const n=$(t,e);return!n||n.type==="element"&&(n.tagName==="option"||n.tagName==="optgroup")}function Ns(r,e,t){const n=$(t,e);return!!(n&&n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot"))}function Ls(r,e,t){const n=$(t,e);return!n||n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot")}function Ps(r,e,t){return!$(t,e)}function Rs(r,e,t){const n=$(t,e);return!n||n.type==="element"&&n.tagName==="tr"}function Jn(r,e,t){const n=$(t,e);return!n||n.type==="element"&&(n.tagName==="td"||n.tagName==="th")}const Is=Vn({body:xs,colgroup:Ms,head:Bs,html:Os,tbody:Us});function Os(r){const e=$(r,-1);return!e||e.type!=="comment"}function Bs(r){const e=r.children,t=[];let n=-1;for(;++n<e.length;){const s=e[n];if(s.type==="element"&&(s.tagName==="title"||s.tagName==="base")){if(t.includes(s.tagName))return!1;t.push(s.tagName)}}return e.length>0}function xs(r){const e=$(r,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&Mt(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function Ms(r,e,t){const n=Kn(t,e),s=$(r,-1,!0);return t&&n&&n.type==="element"&&n.tagName==="colgroup"&&Ut(n,t.children.indexOf(n),t)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function Us(r,e,t){const n=Kn(t,e),s=$(r,-1);return t&&n&&n.type==="element"&&(n.tagName==="thead"||n.tagName==="tbody")&&Ut(n,t.children.indexOf(n),t)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const st={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Gs(r,e,t,n){const s=n.schema,i=s.space==="svg"?!1:n.settings.omitOptionalTags;let l=s.space==="svg"?n.settings.closeEmptyElements:n.settings.voids.includes(r.tagName.toLowerCase());const f=[];let u;s.space==="html"&&r.tagName==="svg"&&(n.schema=jn);const p=Fs(n,r.properties),h=n.all(s.space==="html"&&r.tagName==="template"?r.content:r);return n.schema=s,h&&(l=!1),(p||!i||!Is(r,e,t))&&(f.push("<",r.tagName,p?" "+p:""),l&&(s.space==="svg"||n.settings.closeSelfClosing)&&(u=p.charAt(p.length-1),(!n.settings.tightSelfClosing||u==="/"||u&&u!=='"'&&u!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!l&&(!i||!Ut(r,e,t))&&f.push("</"+r.tagName+">"),f.join("")}function Fs(r,e){const t=[];let n=-1,s;if(e){for(s in e)if(e[s]!==null&&e[s]!==void 0){const i=Ds(r,s,e[s]);i&&t.push(i)}}for(;++n<t.length;){const i=r.settings.tightAttributes?t[n].charAt(t[n].length-1):void 0;n!==t.length-1&&i!=='"'&&i!=="'"&&(t[n]+=" ")}return t.join("")}function Ds(r,e,t){const n=Jo(r.schema,e),s=r.settings.allowParseErrors&&r.schema.space==="html"?0:1,i=r.settings.allowDangerousCharacters?0:1;let l=r.quote,f;if(n.overloadedBoolean&&(t===n.attribute||t==="")?t=!0:(n.boolean||n.overloadedBoolean&&typeof t!="string")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const u=Ce(n.attribute,Object.assign({},r.settings.characterReferences,{subset:st.name[s][i]}));return t===!0||(t=Array.isArray(t)?(n.commaSeparated?gs:ms)(t,{padLeft:!r.settings.tightCommaSeparatedLists}):String(t),r.settings.collapseEmptyAttributes&&!t)?u:(r.settings.preferUnquoted&&(f=Ce(t,Object.assign({},r.settings.characterReferences,{attribute:!0,subset:st.unquoted[s][i]}))),f!==t&&(r.settings.quoteSmart&&Wn(t,l)>Wn(t,r.alternative)&&(l=r.alternative),f=l+Ce(t,Object.assign({},r.settings.characterReferences,{subset:(l==="'"?st.single:st.double)[s][i],attribute:!0}))+l),u+(f&&"="+f))}const $s=["<","&"];function Qn(r,e,t,n){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?r.value:Ce(r.value,Object.assign({},n.settings.characterReferences,{subset:$s}))}function js(r,e,t,n){return n.settings.allowDangerousHtml?r.value:Qn(r,e,t,n)}function zs(r,e,t,n){return n.all(r)}const qs=ts("type",{invalid:Ws,unknown:Hs,handlers:{comment:ps,doctype:ds,element:Gs,raw:js,root:zs,text:Qn}});function Ws(r){throw new Error("Expected node, not `"+r+"`")}function Hs(r){const e=r;throw new Error("Cannot compile unknown node `"+e.type+"`")}const Ks={},Ys={},Vs=[];function Xs(r,e){const t=Ks,n=t.quote||'"',s=n==='"'?"'":'"';if(n!=='"'&&n!=="'")throw new Error("Invalid quote `"+n+"`, expected `'` or `\"`");return{one:Js,all:Qs,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||qo,characterReferences:t.characterReferences||Ys,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?jn:es,quote:n,alternative:s}.one(Array.isArray(r)?{type:"root",children:r}:r,void 0,void 0)}function Js(r,e,t){return qs(r,e,t,this)}function Qs(r){const e=[],t=r&&r.children||Vs;let n=-1;for(;++n<t.length;)e[n]=this.one(t[n],n,r);return e.join("")}function Zs(r,e,t){var i;const n={meta:{},options:t,codeToHast:(l,f)=>rt(r,l,f),codeToTokens:(l,f)=>tt(r,l,f)};let s=Xs(rt(r,e,t,n));for(const l of nt(t))s=((i=l.postprocess)==null?void 0:i.call(n,s,t))||s;return s}async function ei(r){let e,t;const n={};function s(_){t=_,n.HEAPU8=new Uint8Array(_),n.HEAPU32=new Uint32Array(_)}function i(){return typeof performance<"u"?performance.now():Date.now()}function l(_,A,N){n.HEAPU8.copyWithin(_,A,A+N)}function f(){return 2147483648}function u(_){try{return e.grow(_-t.byteLength+65535>>>16),s(e.buffer),1}catch{}}function p(_){const A=n.HEAPU8.length;_=_>>>0;const N=f();if(_>N)return!1;const P=(E,T)=>E+(T-E%T)%T;for(let E=1;E<=4;E*=2){let T=A*(1+.2/E);T=Math.min(T,_+100663296);const L=Math.min(N,P(Math.max(_,T),65536));if(u(L))return!0}return!1}const h=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function y(_,A,N=1024){const P=A+N;let E=A;for(;_[E]&&!(E>=P);)++E;if(E-A>16&&_.buffer&&h)return h.decode(_.subarray(A,E));let T="";for(;A<E;){let L=_[A++];if(!(L&128)){T+=String.fromCharCode(L);continue}const R=_[A++]&63;if((L&224)===192){T+=String.fromCharCode((L&31)<<6|R);continue}const Y=_[A++]&63;if((L&240)===224?L=(L&15)<<12|R<<6|Y:L=(L&7)<<18|R<<12|Y<<6|_[A++]&63,L<65536)T+=String.fromCharCode(L);else{const j=L-65536;T+=String.fromCharCode(55296|j>>10,56320|j&1023)}}return T}function b(_,A){return _?y(n.HEAPU8,_,A):""}const w={emscripten_get_now:i,emscripten_memcpy_big:l,emscripten_resize_heap:p,fd_write:()=>0};async function k(){const _=await r({env:w,wasi_snapshot_preview1:w});e=_.memory,s(e.buffer),Object.assign(n,_),n.UTF8ToString=b}return await k(),n}let q=null,ti=!1;function ni(r){throw new G(r.UTF8ToString(r.getLastOnigError()))}class ut{constructor(e){g(this,"utf16Length");g(this,"utf8Length");g(this,"utf16Value");g(this,"utf8Value");g(this,"utf16OffsetToUtf8");g(this,"utf8OffsetToUtf16");const t=e.length,n=ut._utf8ByteLength(e),s=n!==t,i=s?new Uint32Array(t+1):null;s&&(i[t]=n);const l=s?new Uint32Array(n+1):null;s&&(l[n]=t);const f=new Uint8Array(n);let u=0;for(let p=0;p<t;p++){const h=e.charCodeAt(p);let y=h,b=!1;if(h>=55296&&h<=56319&&p+1<t){const w=e.charCodeAt(p+1);w>=56320&&w<=57343&&(y=(h-55296<<10)+65536|w-56320,b=!0)}s&&(i[p]=u,b&&(i[p+1]=u),y<=127?l[u+0]=p:y<=2047?(l[u+0]=p,l[u+1]=p):y<=65535?(l[u+0]=p,l[u+1]=p,l[u+2]=p):(l[u+0]=p,l[u+1]=p,l[u+2]=p,l[u+3]=p)),y<=127?f[u++]=y:y<=2047?(f[u++]=192|(y&1984)>>>6,f[u++]=128|(y&63)>>>0):y<=65535?(f[u++]=224|(y&61440)>>>12,f[u++]=128|(y&4032)>>>6,f[u++]=128|(y&63)>>>0):(f[u++]=240|(y&1835008)>>>18,f[u++]=128|(y&258048)>>>12,f[u++]=128|(y&4032)>>>6,f[u++]=128|(y&63)>>>0),b&&p++}this.utf16Length=t,this.utf8Length=n,this.utf16Value=e,this.utf8Value=f,this.utf16OffsetToUtf8=i,this.utf8OffsetToUtf16=l}static _utf8ByteLength(e){let t=0;for(let n=0,s=e.length;n<s;n++){const i=e.charCodeAt(n);let l=i,f=!1;if(i>=55296&&i<=56319&&n+1<s){const u=e.charCodeAt(n+1);u>=56320&&u<=57343&&(l=(i-55296<<10)+65536|u-56320,f=!0)}l<=127?t+=1:l<=2047?t+=2:l<=65535?t+=3:t+=4,f&&n++}return t}createString(e){const t=e.omalloc(this.utf8Length);return e.HEAPU8.set(this.utf8Value,t),t}}const J=class J{constructor(e){g(this,"id",++J.LAST_ID);g(this,"_onigBinding");g(this,"content");g(this,"utf16Length");g(this,"utf8Length");g(this,"utf16OffsetToUtf8");g(this,"utf8OffsetToUtf16");g(this,"ptr");if(!q)throw new G("Must invoke loadWasm first.");this._onigBinding=q,this.content=e;const t=new ut(e);this.utf16Length=t.utf16Length,this.utf8Length=t.utf8Length,this.utf16OffsetToUtf8=t.utf16OffsetToUtf8,this.utf8OffsetToUtf16=t.utf8OffsetToUtf16,this.utf8Length<1e4&&!J._sharedPtrInUse?(J._sharedPtr||(J._sharedPtr=q.omalloc(1e4)),J._sharedPtrInUse=!0,q.HEAPU8.set(t.utf8Value,J._sharedPtr),this.ptr=J._sharedPtr):this.ptr=t.createString(q)}convertUtf8OffsetToUtf16(e){return this.utf8OffsetToUtf16?e<0?0:e>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[e]:e}convertUtf16OffsetToUtf8(e){return this.utf16OffsetToUtf8?e<0?0:e>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[e]:e}dispose(){this.ptr===J._sharedPtr?J._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}};g(J,"LAST_ID",0),g(J,"_sharedPtr",0),g(J,"_sharedPtrInUse",!1);let it=J;class ri{constructor(e){g(this,"_onigBinding");g(this,"_ptr");if(!q)throw new G("Must invoke loadWasm first.");const t=[],n=[];for(let f=0,u=e.length;f<u;f++){const p=new ut(e[f]);t[f]=p.createString(q),n[f]=p.utf8Length}const s=q.omalloc(4*e.length);q.HEAPU32.set(t,s/4);const i=q.omalloc(4*e.length);q.HEAPU32.set(n,i/4);const l=q.createOnigScanner(s,i,e.length);for(let f=0,u=e.length;f<u;f++)q.ofree(t[f]);q.ofree(i),q.ofree(s),l===0&&ni(q),this._onigBinding=q,this._ptr=l}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(e,t,n){let s=ti,i=0;if(typeof n=="number"?(n&8&&(s=!0),i=n):typeof n=="boolean"&&(s=n),typeof e=="string"){e=new it(e);const l=this._findNextMatchSync(e,t,s,i);return e.dispose(),l}return this._findNextMatchSync(e,t,s,i)}_findNextMatchSync(e,t,n,s){const i=this._onigBinding;let l;if(n?l=i.findNextOnigScannerMatchDbg(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(t),s):l=i.findNextOnigScannerMatch(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(t),s),l===0)return null;const f=i.HEAPU32;let u=l/4;const p=f[u++],h=f[u++],y=[];for(let b=0;b<h;b++){const w=e.convertUtf8OffsetToUtf16(f[u++]),k=e.convertUtf8OffsetToUtf16(f[u++]);y[b]={start:w,end:k,length:k-w}}return{index:p,captureIndices:y}}}function oi(r){return typeof r.instantiator=="function"}function si(r){return typeof r.default=="function"}function ii(r){return typeof r.data<"u"}function ai(r){return typeof Response<"u"&&r instanceof Response}function li(r){var e;return typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||ArrayBuffer.isView(r))||typeof Pe<"u"&&((e=Pe.isBuffer)==null?void 0:e.call(Pe,r))||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer||typeof Uint32Array<"u"&&r instanceof Uint32Array}let at;function ci(r){if(at)return at;async function e(){q=await ei(async t=>{let n=r;return n=await n,typeof n=="function"&&(n=await n(t)),typeof n=="function"&&(n=await n(t)),oi(n)?n=await n.instantiator(t):si(n)?n=await n.default(t):(ii(n)&&(n=n.data),ai(n)?typeof WebAssembly.instantiateStreaming=="function"?n=await ui(n)(t):n=await hi(n)(t):li(n)?n=await Ft(n)(t):n instanceof WebAssembly.Module?n=await Ft(n)(t):"default"in n&&n.default instanceof WebAssembly.Module&&(n=await Ft(n.default)(t))),"instance"in n&&(n=n.instance),"exports"in n&&(n=n.exports),n})}return at=e(),at}function Ft(r){return e=>WebAssembly.instantiate(r,e)}function ui(r){return e=>WebAssembly.instantiateStreaming(r,e)}function hi(r){return async e=>{const t=await r.arrayBuffer();return WebAssembly.instantiate(t,e)}}function fi(r){return new it(r)}function pi(r){return new ri(r)}const Zn={light:"#333333",dark:"#bbbbbb"},er={light:"#fffffe",dark:"#1e1e1e"},tr="__shiki_resolved";function nr(r){var f,u,p,h,y;if(r!=null&&r[tr])return r;const e={...r};e.tokenColors&&!e.settings&&(e.settings=e.tokenColors,delete e.tokenColors),e.type||(e.type="dark"),e.colorReplacements={...e.colorReplacements},e.settings||(e.settings=[]);let{bg:t,fg:n}=e;if(!t||!n){const b=e.settings?e.settings.find(w=>!w.name&&!w.scope):void 0;(f=b==null?void 0:b.settings)!=null&&f.foreground&&(n=b.settings.foreground),(u=b==null?void 0:b.settings)!=null&&u.background&&(t=b.settings.background),!n&&((p=e==null?void 0:e.colors)!=null&&p["editor.foreground"])&&(n=e.colors["editor.foreground"]),!t&&((h=e==null?void 0:e.colors)!=null&&h["editor.background"])&&(t=e.colors["editor.background"]),n||(n=e.type==="light"?Zn.light:Zn.dark),t||(t=e.type==="light"?er.light:er.dark),e.fg=n,e.bg=t}e.settings[0]&&e.settings[0].settings&&!e.settings[0].scope||e.settings.unshift({settings:{foreground:e.fg,background:e.bg}});let s=0;const i=new Map;function l(b){var k;if(i.has(b))return i.get(b);s+=1;const w=`#${s.toString(16).padStart(8,"0").toLowerCase()}`;return(k=e.colorReplacements)!=null&&k[`#${w}`]?l(b):(i.set(b,w),w)}e.settings=e.settings.map(b=>{var A,N;const w=((A=b.settings)==null?void 0:A.foreground)&&!b.settings.foreground.startsWith("#"),k=((N=b.settings)==null?void 0:N.background)&&!b.settings.background.startsWith("#");if(!w&&!k)return b;const _={...b,settings:{...b.settings}};if(w){const P=l(b.settings.foreground);e.colorReplacements[P]=b.settings.foreground,_.settings.foreground=P}if(k){const P=l(b.settings.background);e.colorReplacements[P]=b.settings.background,_.settings.background=P}return _});for(const b of Object.keys(e.colors||{}))if((b==="editor.foreground"||b==="editor.background"||b.startsWith("terminal.ansi"))&&!((y=e.colors[b])!=null&&y.startsWith("#"))){const w=l(e.colors[b]);e.colorReplacements[w]=e.colors[b],e.colors[b]=w}return Object.defineProperty(e,tr,{enumerable:!1,writable:!1,value:!0}),e}class di extends yo{constructor(t,n,s,i={}){super(t);g(this,"_resolver");g(this,"_themes");g(this,"_langs");g(this,"_alias");g(this,"_resolvedThemes",new Map);g(this,"_resolvedGrammars",new Map);g(this,"_langMap",new Map);g(this,"_langGraph",new Map);g(this,"_textmateThemeCache",new WeakMap);g(this,"_loadedThemesCache",null);g(this,"_loadedLanguagesCache",null);this._resolver=t,this._themes=n,this._langs=s,this._alias=i,n.forEach(l=>this.loadTheme(l)),s.forEach(l=>this.loadLanguage(l))}getTheme(t){return typeof t=="string"?this._resolvedThemes.get(t):this.loadTheme(t)}loadTheme(t){const n=nr(t);return n.name&&(this._resolvedThemes.set(n.name,n),this._loadedThemesCache=null),n}getLoadedThemes(){return this._loadedThemesCache||(this._loadedThemesCache=[...this._resolvedThemes.keys()]),this._loadedThemesCache}setTheme(t){let n=this._textmateThemeCache.get(t);n||(n=Je.createFromRawTheme(t),this._textmateThemeCache.set(t,n)),this._syncRegistry.setTheme(n)}getGrammar(t){if(this._alias[t]){const n=new Set([t]);for(;this._alias[t];){if(t=this._alias[t],n.has(t))throw new G(`Circular alias \`${Array.from(n).join(" -> ")} -> ${t}\``);n.add(t)}}return this._resolvedGrammars.get(t)}async loadLanguage(t){var l,f,u,p;if(this.getGrammar(t.name))return;const n=new Set([...this._langMap.values()].filter(h=>{var y;return(y=h.embeddedLangsLazy)==null?void 0:y.includes(t.name)}));this._resolver.addLanguage(t);const s={balancedBracketSelectors:t.balancedBracketSelectors||["*"],unbalancedBracketSelectors:t.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(t.scopeName,t);const i=await this.loadGrammarWithConfiguration(t.scopeName,1,s);if(i.name=t.name,this._resolvedGrammars.set(t.name,i),t.aliases&&t.aliases.forEach(h=>{this._alias[h]=t.name}),this._loadedLanguagesCache=null,n.size)for(const h of n)this._resolvedGrammars.delete(h.name),this._loadedLanguagesCache=null,(f=(l=this._syncRegistry)==null?void 0:l._injectionGrammars)==null||f.delete(h.scopeName),(p=(u=this._syncRegistry)==null?void 0:u._grammars)==null||p.delete(h.scopeName),await this.loadLanguage(this._langMap.get(h.name))}async init(){this._themes.map(t=>this.loadTheme(t)),await this.loadLanguages(this._langs)}dispose(){super.dispose(),this._resolvedThemes.clear(),this._resolvedGrammars.clear(),this._langMap.clear(),this._langGraph.clear(),this._loadedThemesCache=null}async loadLanguages(t){for(const i of t)this.resolveEmbeddedLanguages(i);const n=Array.from(this._langGraph.entries()),s=n.filter(([i,l])=>!l);if(s.length){const i=n.filter(([l,f])=>{var u;return f&&((u=f.embeddedLangs)==null?void 0:u.some(p=>s.map(([h])=>h).includes(p)))}).filter(l=>!s.includes(l));throw new G(`Missing languages ${s.map(([l])=>`\`${l}\``).join(", ")}, required by ${i.map(([l])=>`\`${l}\``).join(", ")}`)}for(const[i,l]of n)this._resolver.addLanguage(l);for(const[i,l]of n)await this.loadLanguage(l)}getLoadedLanguages(){return this._loadedLanguagesCache||(this._loadedLanguagesCache=[...new Set([...this._resolvedGrammars.keys(),...Object.keys(this._alias)])]),this._loadedLanguagesCache}resolveEmbeddedLanguages(t){if(this._langMap.set(t.name,t),this._langGraph.set(t.name,t),t.embeddedLangs)for(const n of t.embeddedLangs)this._langGraph.set(n,this._langMap.get(n))}}class gi{constructor(e,t){g(this,"_langs",new Map);g(this,"_scopeToLang",new Map);g(this,"_injections",new Map);g(this,"_onigLibPromise");this._onigLibPromise=e,t.forEach(n=>this.addLanguage(n))}get onigLib(){return this._onigLibPromise}getLangRegistration(e){return this._langs.get(e)}async loadGrammar(e){return this._scopeToLang.get(e)}addLanguage(e){this._langs.set(e.name,e),e.aliases&&e.aliases.forEach(t=>{this._langs.set(t,e)}),this._scopeToLang.set(e.scopeName,e),e.injectTo&&e.injectTo.forEach(t=>{this._injections.get(t)||this._injections.set(t,[]),this._injections.get(t).push(e.scopeName)})}getInjections(e){const t=e.split(".");let n=[];for(let s=1;s<=t.length;s++){const i=t.slice(0,s).join(".");n=[...n,...this._injections.get(i)||[]]}return n}}let mi,lt=0;async function yi(r={}){lt+=1,r.warnings!==!1&&lt>=10&&lt%10;let e=!1;async function t(E){return Promise.resolve(typeof E=="function"?E():E).then(T=>T.default||T)}async function n(E){return Array.from(new Set((await Promise.all(E.filter(T=>!bo(T)).map(async T=>await t(T).then(L=>Array.isArray(L)?L:[L])))).flat()))}const s=r.loadWasm||mi,[i,l]=await Promise.all([Promise.all((r.themes||[]).map(t)).then(E=>E.map(nr)),n(r.langs||[]),s?ci(s):void 0]),f=new gi(Promise.resolve({createOnigScanner(E){return pi(E)},createOnigString(E){return fi(E)}}),l),u=new di(f,i,l,r.langAlias);await u.init();let p;function h(E){N();const T=u.getGrammar(typeof E=="string"?E:E.name);if(!T)throw new G(`Language \`${E}\` not found, you may need to load it first`);return T}function y(E){if(E==="none")return{bg:"",fg:"",name:"none",settings:[],type:"dark"};N();const T=u.getTheme(E);if(!T)throw new G(`Theme \`${E}\` not found, you may need to load it first`);return T}function b(E){N();const T=y(E);p!==E&&(u.setTheme(T),p=E);const L=u.getColorMap();return{theme:T,colorMap:L}}function w(){return N(),u.getLoadedThemes()}function k(){return N(),u.getLoadedLanguages()}async function _(...E){N(),await u.loadLanguages(await n(E))}async function A(...E){N(),await Promise.all(E.map(async T=>_o(T)?null:u.loadTheme(await t(T))))}function N(){if(e)throw new G("Shiki instance has been disposed")}function P(){e||(e=!0,u.dispose(),lt-=1)}return{setTheme:b,getTheme:y,getLanguage:h,getLoadedThemes:w,getLoadedLanguages:k,loadLanguage:_,loadTheme:A,dispose:P,[Symbol.dispose]:P}}async function bi(r={}){const e=await yi(r);return{getLastGrammarState:(t,n)=>Io(e,t,n),codeToTokensBase:(t,n)=>Nt(e,t,n),codeToTokensWithThemes:(t,n)=>Rn(e,t,n),codeToTokens:(t,n)=>tt(e,t,n),codeToHast:(t,n)=>rt(e,t,n),codeToHtml:(t,n)=>Zs(e,t,n),...e,getInternalContext:()=>e}}function _i(r){let e="rules"in r?r.rules:void 0;if(!e){e=[];const n=r.settings||r.tokenColors;for(const{scope:s,settings:i}of n){const l=Array.isArray(s)?s:[s];for(const f of l)i.foreground&&f&&e.push({token:f,foreground:ct(i.foreground)})}}const t=Object.fromEntries(Object.entries(r.colors||{}).map(([n,s])=>[n,`#${ct(s)}`]));return{base:r.type==="light"?"vs":"vs-dark",inherit:!1,colors:t,rules:e}}function wi(r,e,t={}){const n=new Map,s=r.getLoadedThemes();for(const b of s){const w=r.getTheme(b),k=_i(w);n.set(b,k),e.editor.defineTheme(b,k)}const i=[],l=new Map,f=e.editor.setTheme.bind(e.editor);e.editor.setTheme=b=>{const w=r.setTheme(b),k=n.get(b);i.length=w.colorMap.length,w.colorMap.forEach((_,A)=>{i[A]=_}),l.clear(),k==null||k.rules.forEach(_=>{const A=ct(_.foreground);A&&!l.has(A)&&l.set(A,_.token)}),f(b)},e.editor.setTheme(s[0]);function u(b){return l.get(b)}const{tokenizeMaxLineLength:p=2e4,tokenizeTimeLimit:h=500}=t,y=new Set(e.languages.getLanguages().map(b=>b.id));for(const b of r.getLoadedLanguages())y.has(b)&&e.languages.setTokensProvider(b,{getInitialState(){return new Fe(Cn)},tokenize(w,k){if(w.length>=p)return{endState:k,tokens:[{startIndex:0,scopes:""}]};const _=r.getLanguage(b).tokenizeLine2(w,k.ruleStack,h);_.stoppedEarly;const A=_.tokens.length/2,N=[];for(let P=0;P<A;P++){const E=_.tokens[2*P],T=_.tokens[2*P+1],L=ct(i[ie.getForeground(T)]||""),R=u(L)||"";N.push({startIndex:E,scopes:R})}return{endState:new Fe(_.ruleStack),tokens:N}}})}class Fe{constructor(e){this._ruleStack=e}get ruleStack(){return this._ruleStack}clone(){return new Fe(this._ruleStack)}equals(e){return!(!e||!(e instanceof Fe)||e!==this||e._ruleStack!==this._ruleStack)}}function ct(r){return r&&(r=(r.charCodeAt(0)===35?r.slice(1):r).toLowerCase(),(r.length===3||r.length===4)&&(r=r.split("").map(e=>e+e).join("")),r)}export{Pe as B,wr as _,bi as c,Ar as p,wi as s};
